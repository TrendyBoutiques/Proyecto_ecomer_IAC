<?xml version="1.0" ?>
<testsuites disabled="0" errors="0" failures="101" tests="447" time="0.0">
	<testsuite disabled="0" errors="0" failures="101" name="terraform scan" skipped="0" tests="447" time="0">
		<properties>
			<property name="directory" value="['/tf']"/>
			<property name="add_check" value="False"/>
			<property name="list" value="False"/>
			<property name="output" value="['junitxml']"/>
			<property name="output_file_path" value="results.xml"/>
			<property name="output_bc_ids" value="False"/>
			<property name="include_all_checkov_policies" value="True"/>
			<property name="quiet" value="False"/>
			<property name="compact" value="False"/>
			<property name="framework" value="['all']"/>
			<property name="skip_framework" value="[]"/>
			<property name="run_all_external_checks" value="False"/>
			<property name="soft_fail" value="False"/>
			<property name="skip_results_upload" value="False"/>
			<property name="repo_id" value="cli_repo/tf"/>
			<property name="branch" value="master"/>
			<property name="skip_download" value="False"/>
			<property name="use_enforcement_rules" value="False"/>
			<property name="external_modules_download_path" value=".external_modules"/>
			<property name="evaluate_variables" value="True"/>
			<property name="no_cert_verify" value="False"/>
			<property name="create_baseline" value="False"/>
			<property name="output_baseline_as_skipped" value="False"/>
			<property name="secrets_scan_file_type" value="[]"/>
			<property name="enable_secret_scan_all_files" value="False"/>
			<property name="block_list_secret_scan" value="[]"/>
			<property name="summary_position" value="top"/>
			<property name="skip_resources_without_violations" value="False"/>
			<property name="deep_analysis" value="False"/>
			<property name="no_fail_on_crash" value="False"/>
			<property name="mask" value="defaultdict(&lt;class 'set'&gt;, {})"/>
			<property name="scan_secrets_history" value="False"/>
			<property name="secrets_history_timeout" value="12h"/>
			<property name="custom_tool_name" value="Checkov"/>
		</properties>
		<testcase name="[NONE][CKV_AWS_237] Ensure Create before destroy for API Gateway" classname="/apigateway.tf.aws_api_gateway_rest_api.main" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV2_AWS_70] Ensure API gateway method has authorization or API key set" classname="/apigateway.tf.aws_api_gateway_method.endpoint_methods" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;card&quot;]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="/apigateway.tf.aws_lambda_permission.api_gateway_permissions" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/apigateway.tf.aws_lambda_permission.api_gateway_permissions" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_217] Ensure Create before destroy for API deployments" classname="/apigateway.tf.aws_api_gateway_deployment.main" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_76] Ensure API Gateway has Access Logging enabled" classname="/apigateway.tf.aws_api_gateway_stage.main" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/apigateway.tf.aws_cloudwatch_log_group.api_gateway[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/apigateway.tf.aws_iam_role.api_gateway_cloudwatch_logs[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/apigateway.tf.aws_iam_role.api_gateway_cloudwatch_logs[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/apigateway.tf.aws_iam_role.api_gateway_cloudwatch_logs[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/apigateway.tf.aws_iam_role_policy_attachment.api_gateway_cloudwatch_logs_attachment[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;catalogo&quot;]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;orderandshipping&quot;]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;purchase&quot;]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;purchase-confirmation&quot;]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;registrations&quot;]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_68] CloudFront Distribution should have WAF enabled" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf"/>
		<testcase name="[NONE][CKV_AWS_216] Ensure CloudFront distribution is enabled" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf"/>
		<testcase name="[NONE][CKV_AWS_305] Ensure CloudFront distribution has a default root object configured" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf"/>
		<testcase name="[NONE][CKV_AWS_34] Ensure CloudFront distribution ViewerProtocolPolicy is set to HTTPS" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf"/>
		<testcase name="[NONE][CKV_AWS_366] Ensure AWS Cognito identity pool does not allow unauthenticated guest access" classname="/cognito.tf.aws_cognito_identity_pool.main" file="/cognito.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/cognito.tf.aws_iam_role.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/cognito.tf.aws_iam_role.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/cognito.tf.aws_iam_role.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV_AWS_227] Ensure KMS key is enabled" classname="/dynamodb.tf.aws_kms_key.dynamodb_key" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_7] Ensure rotation for customer created CMKs is enabled" classname="/dynamodb.tf.aws_kms_key.dynamodb_key" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_33] Ensure KMS key policy does not contain wildcard (*) principal" classname="/dynamodb.tf.aws_kms_key.dynamodb_key" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_119] Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK" classname="/dynamodb.tf.aws_dynamodb_table.users_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_28] Ensure DynamoDB point in time recovery (backup) is enabled" classname="/dynamodb.tf.aws_dynamodb_table.users_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_119] Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK" classname="/dynamodb.tf.aws_dynamodb_table.products_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_28] Ensure DynamoDB point in time recovery (backup) is enabled" classname="/dynamodb.tf.aws_dynamodb_table.products_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_119] Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK" classname="/dynamodb.tf.aws_dynamodb_table.cards_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_28] Ensure DynamoDB point in time recovery (backup) is enabled" classname="/dynamodb.tf.aws_dynamodb_table.cards_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_119] Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK" classname="/dynamodb.tf.aws_dynamodb_table.orders_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_28] Ensure DynamoDB point in time recovery (backup) is enabled" classname="/dynamodb.tf.aws_dynamodb_table.orders_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_119] Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK" classname="/dynamodb.tf.aws_dynamodb_table.order_items_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_28] Ensure DynamoDB point in time recovery (backup) is enabled" classname="/dynamodb.tf.aws_dynamodb_table.order_items_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_119] Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK" classname="/dynamodb.tf.aws_dynamodb_table.shipping_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_28] Ensure DynamoDB point in time recovery (backup) is enabled" classname="/dynamodb.tf.aws_dynamodb_table.shipping_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/dynamodb.tf.aws_iam_policy.users_dynamodb_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/dynamodb.tf.aws_iam_policy.users_dynamodb_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/dynamodb.tf.aws_iam_policy.cards_dynamodb_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/dynamodb.tf.aws_iam_policy.cards_dynamodb_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/dynamodb.tf.aws_iam_policy.products_dynamodb_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/dynamodb.tf.aws_iam_policy.products_dynamodb_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/dynamodb.tf.aws_iam_policy.orders_dynamodb_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/dynamodb.tf.aws_iam_policy.orders_dynamodb_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_110] Ensure IAM policies does not allow privilege escalation" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_358] Ensure AWS GitHub Actions OIDC authorization policies only allow safe claims and claim order" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_49] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_283] Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_1] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_107] Ensure IAM policies does not allow credentials exposure" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_108] Ensure IAM policies does not allow data exfiltration" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/grafana.tf.aws_iam_role.grafana" file="/grafana.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/grafana.tf.aws_iam_role.grafana" file="/grafana.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/grafana.tf.aws_iam_role.grafana" file="/grafana.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/grafana.tf.aws_iam_role_policy_attachment.grafana_cloudwatch" file="/grafana.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-card.tf.aws_iam_role.lambda_card_exec_role" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/lambda-card.tf.aws_iam_role.lambda_card_exec_role" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/lambda-card.tf.aws_iam_role.lambda_card_exec_role" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/lambda-card.tf.aws_cloudwatch_log_group.card_logs" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-card.tf.aws_iam_policy.card_logs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-card.tf.aws_iam_policy.card_logs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-card.tf.aws_iam_role_policy_attachment.card_logs_attach" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-card.tf.aws_iam_role_policy_attachment.card_dynamodb_attach" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-card.tf.aws_iam_role_policy_attachment.card_kms_attach" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-card.tf.aws_iam_role_policy_attachment.card_vpc_attach" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-card.tf.aws_iam_role_policy_attachment.card_basic_execution" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-card.tf.aws_iam_role_policy_attachment.card_sqs_attach" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-catalogo.tf.aws_iam_role.lambda_catalogo_exec_role" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/lambda-catalogo.tf.aws_iam_role.lambda_catalogo_exec_role" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/lambda-catalogo.tf.aws_iam_role.lambda_catalogo_exec_role" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/lambda-catalogo.tf.aws_cloudwatch_log_group.catalogo_logs" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-catalogo.tf.aws_iam_role_policy_attachment.catalogo_logs_attach" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-catalogo.tf.aws_iam_role_policy_attachment.catalogo_dynamodb_attach" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-catalogo.tf.aws_iam_role_policy_attachment.catalogo_vpc_attach" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-catalogo.tf.aws_iam_role_policy_attachment.catalogo_basic_execution" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-ordenAndShipping.tf.aws_iam_role.lambda_orderandshipping_exec_role" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/lambda-ordenAndShipping.tf.aws_iam_role.lambda_orderandshipping_exec_role" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/lambda-ordenAndShipping.tf.aws_iam_role.lambda_orderandshipping_exec_role" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/lambda-ordenAndShipping.tf.aws_cloudwatch_log_group.orderandshipping_logs" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_dynamodb_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_dynamodb_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-ordenAndShipping.tf.aws_iam_role_policy_attachment.orderandshipping_logs_attach" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-ordenAndShipping.tf.aws_iam_role_policy_attachment.orderandshipping_dynamodb_attach" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-ordenAndShipping.tf.aws_iam_role_policy_attachment.orderandshipping_ses_attach" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-ordenAndShipping.tf.aws_iam_role_policy_attachment.orderandshipping_sqs_attach" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-ordenAndShipping.tf.aws_iam_role_policy_attachment.orderandshipping_vpc_attach" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-ordenAndShipping.tf.aws_iam_role_policy_attachment.orderandshipping_basic_execution" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-purchase-confirmation.tf.aws_iam_role.lambda_purchase_confirmation_role" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/lambda-purchase-confirmation.tf.aws_iam_role.lambda_purchase_confirmation_role" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/lambda-purchase-confirmation.tf.aws_iam_role.lambda_purchase_confirmation_role" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/lambda-purchase-confirmation.tf.aws_cloudwatch_log_group.purchase_confirmation_logs" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-purchase-confirmation.tf.aws_iam_role_policy_attachment.purchase_confirmation_policy_attach" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-purchase.tf.aws_iam_role.lambda_purchase_exec_role" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/lambda-purchase.tf.aws_iam_role.lambda_purchase_exec_role" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/lambda-purchase.tf.aws_iam_role.lambda_purchase_exec_role" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/lambda-purchase.tf.aws_cloudwatch_log_group.purchase_logs" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-purchase.tf.aws_iam_policy.purchase_dynamodb_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-purchase.tf.aws_iam_policy.purchase_dynamodb_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-purchase.tf.aws_iam_role_policy_attachment.purchase_logs_attach" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-purchase.tf.aws_iam_role_policy_attachment.purchase_dynamodb_attach" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-purchase.tf.aws_iam_role_policy_attachment.purchase_kms_attach" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-purchase.tf.aws_iam_role_policy_attachment.purchase_vpc_attach" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-purchase.tf.aws_iam_role_policy_attachment.purchase_basic_execution" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_319] Ensure that CloudWatch alarm actions are enabled" classname="/lambda-purchase.tf.aws_cloudwatch_metric_alarm.purchase_errors" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_319] Ensure that CloudWatch alarm actions are enabled" classname="/lambda-purchase.tf.aws_cloudwatch_metric_alarm.purchase_throttles" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-registrations.tf.aws_iam_role.lambda_registrations_exec_role" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/lambda-registrations.tf.aws_iam_role.lambda_registrations_exec_role" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/lambda-registrations.tf.aws_iam_role.lambda_registrations_exec_role" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/lambda-registrations.tf.aws_cloudwatch_log_group.registrations_logs" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-registrations.tf.aws_iam_role_policy_attachment.registrations_logs_attach" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-registrations.tf.aws_iam_role_policy_attachment.registrations_cognito_attach" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-registrations.tf.aws_iam_role_policy_attachment.registrations_vpc_attach" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-registrations.tf.aws_iam_role_policy_attachment.registrations_basic_execution" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda-send-emails-order.tf.aws_iam_role.lambda_send_emails_order_exec_role" file="/lambda-send-emails-order.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/lambda-send-emails-order.tf.aws_iam_role.lambda_send_emails_order_exec_role" file="/lambda-send-emails-order.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/lambda-send-emails-order.tf.aws_iam_role.lambda_send_emails_order_exec_role" file="/lambda-send-emails-order.tf"/>
		<testcase name="[NONE][CKV_AWS_41] Ensure no hard coded AWS access key and secret key exists in provider" classname="/main.tf.aws.default" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_41] Ensure no hard coded AWS access key and secret key exists in provider" classname="/main.tf.aws.waf_region" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_168] Ensure SQS queue policy is not public by only allowing specific services or principals to access it" classname="/queueEmails.tf.aws_sqs_queue.email_dlq" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_168] Ensure SQS queue policy is not public by only allowing specific services or principals to access it" classname="/queueEmails.tf.aws_sqs_queue.email_queue" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV_AWS_93] Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV_AWS_55] Ensure S3 bucket has ignore public ACLs enabled" classname="/s3.tf.aws_s3_bucket_public_access_block.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV_AWS_56] Ensure S3 bucket has 'restrict_public_buckets' enabled" classname="/s3.tf.aws_s3_bucket_public_access_block.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV_AWS_53] Ensure S3 bucket has block public ACLS enabled" classname="/s3.tf.aws_s3_bucket_public_access_block.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV_AWS_54] Ensure S3 bucket has block public policy enabled" classname="/s3.tf.aws_s3_bucket_public_access_block.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV_AWS_93] Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)" classname="/s3.tf.aws_s3_bucket_policy.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV_AWS_70] Ensure S3 bucket does not allow an action with any Principal" classname="/s3.tf.aws_s3_bucket_policy.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/ses.tf.aws_iam_role_policy_attachment.send_emails_order_ses_attach" file="/ses.tf"/>
		<testcase name="[NONE][CKV_AWS_168] Ensure SQS queue policy is not public by only allowing specific services or principals to access it" classname="/sns.tf.aws_sqs_queue_policy.email_queue_sns_policy" file="/sns.tf"/>
		<testcase name="[NONE][CKV_AWS_72] Ensure SQS policy does not allow ALL (*) actions." classname="/sns.tf.aws_sqs_queue_policy.email_queue_sns_policy" file="/sns.tf"/>
		<testcase name="[NONE][CKV_AWS_387] Ensure SQS policy does not allow public access through wildcards" classname="/sns.tf.aws_sqs_queue_policy.email_queue_sns_policy" file="/sns.tf"/>
		<testcase name="[NONE][CKV_AWS_168] Ensure SQS queue policy is not public by only allowing specific services or principals to access it" classname="/sqs.tf.aws_sqs_queue.purchase_queue" file="/sqs.tf"/>
		<testcase name="[NONE][CKV_AWS_168] Ensure SQS queue policy is not public by only allowing specific services or principals to access it" classname="/sqs.tf.aws_sqs_queue.send_emails_order_queue" file="/sqs.tf"/>
		<testcase name="[NONE][CKV_AWS_130] Ensure VPC subnets do not assign public IP by default" classname="/vpc.tf.aws_subnet.private[0]" file="/vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_260] Ensure no security groups allow ingress from 0.0.0.0:0 to port 80" classname="/vpc.tf.aws_security_group.lambda" file="/vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_277] Ensure no security groups allow ingress from 0.0.0.0:0 to port -1" classname="/vpc.tf.aws_security_group.lambda" file="/vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_24] Ensure no security groups allow ingress from 0.0.0.0:0 to port 22" classname="/vpc.tf.aws_security_group.lambda" file="/vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_25] Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389" classname="/vpc.tf.aws_security_group.lambda" file="/vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_130] Ensure VPC subnets do not assign public IP by default" classname="/vpc.tf.aws_subnet.private[1]" file="/vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_175] Ensure WAF has associated rules" classname="/waf.tf.aws_wafv2_web_acl.main" file="/waf.tf"/>
		<testcase name="[NONE][CKV_AWS_342] Ensure WAF rule has any actions" classname="/waf.tf.aws_wafv2_web_acl.main" file="/waf.tf"/>
		<testcase name="[NONE][CKV_AWS_20] S3 Bucket has an ACL defined which allows public READ access." classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV2_AWS_32] Ensure CloudFront distribution has a response headers policy attached" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf"/>
		<testcase name="[NONE][CKV2_AWS_77] Ensure AWS API Gateway Rest API attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="/apigateway.tf.aws_api_gateway_stage.main" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/apigateway.tf.aws_iam_role.api_gateway_cloudwatch_logs[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/cognito.tf.aws_iam_role.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/grafana.tf.aws_iam_role.grafana" file="/grafana.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/grafana.tf.aws_iam_role_policy_attachment.grafana_cloudwatch" file="/grafana.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-card.tf.aws_iam_role.lambda_card_exec_role" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-card.tf.aws_iam_role_policy_attachment.card_vpc_attach" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-card.tf.aws_iam_role_policy_attachment.card_basic_execution" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-catalogo.tf.aws_iam_role.lambda_catalogo_exec_role" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-catalogo.tf.aws_iam_role_policy_attachment.catalogo_vpc_attach" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-catalogo.tf.aws_iam_role_policy_attachment.catalogo_basic_execution" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-ordenAndShipping.tf.aws_iam_role.lambda_orderandshipping_exec_role" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-ordenAndShipping.tf.aws_iam_role_policy_attachment.orderandshipping_vpc_attach" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-ordenAndShipping.tf.aws_iam_role_policy_attachment.orderandshipping_basic_execution" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-purchase-confirmation.tf.aws_iam_role.lambda_purchase_confirmation_role" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-purchase.tf.aws_iam_role.lambda_purchase_exec_role" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-purchase.tf.aws_iam_role_policy_attachment.purchase_vpc_attach" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-purchase.tf.aws_iam_role_policy_attachment.purchase_basic_execution" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-registrations.tf.aws_iam_role.lambda_registrations_exec_role" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-registrations.tf.aws_iam_role_policy_attachment.registrations_vpc_attach" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-registrations.tf.aws_iam_role_policy_attachment.registrations_basic_execution" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda-send-emails-order.tf.aws_iam_role.lambda_send_emails_order_exec_role" file="/lambda-send-emails-order.tf"/>
		<testcase name="[NONE][CKV2_AWS_6] Ensure that S3 bucket has a Public Access block" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV_AWS_21] Ensure all data stored in the S3 bucket have versioning enabled" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV2_AWS_35] AWS NAT Gateways should be utilized for the default route" classname="/vpc.tf.aws_route_table.public" file="/vpc.tf"/>
		<testcase name="[NONE][CKV2_AWS_35] AWS NAT Gateways should be utilized for the default route" classname="/vpc.tf.aws_route_table.private" file="/vpc.tf"/>
		<testcase name="[NONE][CKV2_AWS_73] Ensure AWS SQS uses CMK not AWS default keys for encryption" classname="/queueEmails.tf.aws_sqs_queue.email_dlq" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV2_AWS_73] Ensure AWS SQS uses CMK not AWS default keys for encryption" classname="/queueEmails.tf.aws_sqs_queue.email_queue" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV2_AWS_73] Ensure AWS SQS uses CMK not AWS default keys for encryption" classname="/sqs.tf.aws_sqs_queue.purchase_queue" file="/sqs.tf"/>
		<testcase name="[NONE][CKV2_AWS_73] Ensure AWS SQS uses CMK not AWS default keys for encryption" classname="/sqs.tf.aws_sqs_queue.send_emails_order_queue" file="/sqs.tf"/>
		<testcase name="[NONE][CKV2_AWS_44] Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic" classname="/vpc.tf.aws_route_table.public" file="/vpc.tf"/>
		<testcase name="[NONE][CKV2_AWS_44] Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic" classname="/vpc.tf.aws_route_table.private" file="/vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_57] S3 Bucket has an ACL defined which allows public WRITE access." classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV2_AWS_19] Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances" classname="/vpc.tf.aws_eip.nat" file="/vpc.tf"/>
		<testcase name="[NONE][CKV2_AWS_5] Ensure that Security Groups are attached to another resource" classname="/vpc.tf.aws_security_group.lambda" file="/vpc.tf"/>
		<testcase name="[NONE][CKV2_AWS_64] Ensure KMS key Policy is defined" classname="/dynamodb.tf.aws_kms_key.dynamodb_key" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/dynamodb.tf.aws_iam_policy.lambda_kms_policy" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-card.tf.aws_iam_policy.card_sqs_policy" file="/lambda-card.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_logs_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-catalogo.tf.aws_iam_policy.catalogo_dynamodb_policy" file="/lambda-catalogo.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_logs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_sqs_policy" file="/lambda-ordenAndShipping.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-purchase.tf.aws_iam_policy.purchase_logs_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-purchase.tf.aws_iam_policy.purchase_kms_policy" file="/lambda-purchase.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-registrations.tf.aws_iam_policy.registrations_logs_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda-registrations.tf.aws_iam_policy.registrations_cognito_policy" file="/lambda-registrations.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/queueEmails.tf.aws_iam_policy.send_emails_sqs_policy" file="/queueEmails.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/ses.tf.aws_iam_policy.lambda_ses_policy" file="/ses.tf"/>
		<testcase name="[NONE][CKV2_AWS_46] Ensure AWS CloudFront Distribution with S3 have Origin Access set to enabled" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf"/>
		<testcase name="[NONE][CKV2_AWS_72] Ensure AWS CloudFront origin protocol policy enforces HTTPS-only" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf"/>
		<testcase name="[NONE][CKV2_AWS_54] Ensure AWS CloudFront distribution is using secure SSL protocols for HTTPS communication" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf"/>
		<testcase name="[NONE][CKV_AWS_19] Ensure all data stored in the S3 bucket is securely encrypted at rest" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf"/>
		<testcase name="[NONE][CKV2_AWS_16] Ensure that Auto Scaling is enabled on your DynamoDB tables" classname="/dynamodb.tf.aws_dynamodb_table.users_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV2_AWS_16] Ensure that Auto Scaling is enabled on your DynamoDB tables" classname="/dynamodb.tf.aws_dynamodb_table.products_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV2_AWS_16] Ensure that Auto Scaling is enabled on your DynamoDB tables" classname="/dynamodb.tf.aws_dynamodb_table.cards_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV2_AWS_16] Ensure that Auto Scaling is enabled on your DynamoDB tables" classname="/dynamodb.tf.aws_dynamodb_table.orders_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV2_AWS_16] Ensure that Auto Scaling is enabled on your DynamoDB tables" classname="/dynamodb.tf.aws_dynamodb_table.order_items_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV2_AWS_16] Ensure that Auto Scaling is enabled on your DynamoDB tables" classname="/dynamodb.tf.aws_dynamodb_table.shipping_table" file="/dynamodb.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="/apigateway.tf.aws_api_gateway_method.endpoint_methods" file="/apigateway.tf">
			<failure type="failure" message="Ensure there is no open access to back-end resources through API">
Resource: aws_api_gateway_method.endpoint_methods
File: /apigateway.tf: 111-132
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-6-api-gateway-authorizer-set

		111 | resource &quot;aws_api_gateway_method&quot; &quot;endpoint_methods&quot; {
		112 |   for_each = {
		113 |     for combo in flatten([for endpoint_key, endpoint in local.endpoints : [
		114 |       for method in endpoint.methods : {
		115 |         key           = &quot;${endpoint_key}_${method}&quot;
		116 |         endpoint_key  = endpoint_key
		117 |         method        = method
		118 |         authorization = endpoint.authorization
		119 |       } if method != &quot;OPTIONS&quot;
		120 |     ]]) : combo.key =&gt; combo
		121 |   }
		122 | 
		123 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		124 |   resource_id   = aws_api_gateway_resource.endpoints[each.value.endpoint_key].id
		125 |   http_method   = each.value.method
		126 |   authorization = each.value.authorization == &quot;COGNITO_USER_POOLS&quot; &amp;&amp; var.cognito_user_pool_arn != &quot;&quot; ? &quot;COGNITO_USER_POOLS&quot; : &quot;NONE&quot;
		127 |   authorizer_id = each.value.authorization == &quot;COGNITO_USER_POOLS&quot; &amp;&amp; var.cognito_user_pool_arn != &quot;&quot; ? aws_api_gateway_authorizer.cognito[0].id : null
		128 | 
		129 |   request_parameters = each.value.authorization == &quot;COGNITO_USER_POOLS&quot; &amp;&amp; var.cognito_user_pool_arn != &quot;&quot; ? {
		130 |     &quot;method.request.header.Authorization&quot; = true
		131 |   } : {}
		132 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_120] Ensure API Gateway caching is enabled" classname="/apigateway.tf.aws_api_gateway_stage.main" file="/apigateway.tf">
			<failure type="failure" message="Ensure API Gateway caching is enabled">
Resource: aws_api_gateway_stage.main
File: /apigateway.tf: 269-299
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-api-gateway-caching-is-enabled

		269 | resource &quot;aws_api_gateway_stage&quot; &quot;main&quot; {
		270 |   stage_name    = var.environment
		271 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		272 |   deployment_id = aws_api_gateway_deployment.main.id
		273 | 
		274 |   depends_on = [aws_api_gateway_account.main]
		275 | 
		276 |   dynamic &quot;access_log_settings&quot; {
		277 |     for_each = var.enable_api_gateway_logging ? [1] : []
		278 |     content {
		279 |       destination_arn = aws_cloudwatch_log_group.api_gateway[0].arn
		280 |       format = jsonencode({
		281 |         requestId      = &quot;$context.requestId&quot;
		282 |         ip             = &quot;$context.identity.sourceIp&quot;
		283 |         caller         = &quot;$context.identity.caller&quot;
		284 |         user           = &quot;$context.identity.user&quot;
		285 |         requestTime    = &quot;$context.requestTime&quot;
		286 |         httpMethod     = &quot;$context.httpMethod&quot;
		287 |         resourcePath   = &quot;$context.resourcePath&quot;
		288 |         status         = &quot;$context.status&quot;
		289 |         protocol       = &quot;$context.protocol&quot;
		290 |         responseLength = &quot;$context.response.header.Content-Length&quot;
		291 |       })
		292 |     }
		293 |   }
		294 | 
		295 |   tags = merge(var.common_tags, {
		296 |     Name        = &quot;${var.project_name}-${var.environment}-api-stage&quot;
		297 |     Environment = var.environment
		298 |   })
		299 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_73] Ensure API Gateway has X-Ray Tracing enabled" classname="/apigateway.tf.aws_api_gateway_stage.main" file="/apigateway.tf">
			<failure type="failure" message="Ensure API Gateway has X-Ray Tracing enabled">
Resource: aws_api_gateway_stage.main
File: /apigateway.tf: 269-299
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-15

		269 | resource &quot;aws_api_gateway_stage&quot; &quot;main&quot; {
		270 |   stage_name    = var.environment
		271 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		272 |   deployment_id = aws_api_gateway_deployment.main.id
		273 | 
		274 |   depends_on = [aws_api_gateway_account.main]
		275 | 
		276 |   dynamic &quot;access_log_settings&quot; {
		277 |     for_each = var.enable_api_gateway_logging ? [1] : []
		278 |     content {
		279 |       destination_arn = aws_cloudwatch_log_group.api_gateway[0].arn
		280 |       format = jsonencode({
		281 |         requestId      = &quot;$context.requestId&quot;
		282 |         ip             = &quot;$context.identity.sourceIp&quot;
		283 |         caller         = &quot;$context.identity.caller&quot;
		284 |         user           = &quot;$context.identity.user&quot;
		285 |         requestTime    = &quot;$context.requestTime&quot;
		286 |         httpMethod     = &quot;$context.httpMethod&quot;
		287 |         resourcePath   = &quot;$context.resourcePath&quot;
		288 |         status         = &quot;$context.status&quot;
		289 |         protocol       = &quot;$context.protocol&quot;
		290 |         responseLength = &quot;$context.response.header.Content-Length&quot;
		291 |       })
		292 |     }
		293 |   }
		294 | 
		295 |   tags = merge(var.common_tags, {
		296 |     Name        = &quot;${var.project_name}-${var.environment}-api-stage&quot;
		297 |     Environment = var.environment
		298 |   })
		299 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/apigateway.tf.aws_cloudwatch_log_group.api_gateway[0]" file="/apigateway.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.api_gateway[0]
File: /apigateway.tf: 302-311
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		302 | resource &quot;aws_cloudwatch_log_group&quot; &quot;api_gateway&quot; {
		303 |   count             = var.enable_api_gateway_logging ? 1 : 0
		304 |   name              = &quot;/aws/apigateway/${var.project_name}-${var.environment}&quot;
		305 |   retention_in_days = var.cloudwatch_log_retention_days
		306 | 
		307 |   tags = merge(var.common_tags, {
		308 |     Name        = &quot;${var.project_name}-${var.environment}-api-logs&quot;
		309 |     Environment = var.environment
		310 |   })
		311 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/apigateway.tf.aws_cloudwatch_log_group.api_gateway[0]" file="/apigateway.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.api_gateway[0]
File: /apigateway.tf: 302-311
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		302 | resource &quot;aws_cloudwatch_log_group&quot; &quot;api_gateway&quot; {
		303 |   count             = var.enable_api_gateway_logging ? 1 : 0
		304 |   name              = &quot;/aws/apigateway/${var.project_name}-${var.environment}&quot;
		305 |   retention_in_days = var.cloudwatch_log_retention_days
		306 | 
		307 |   tags = merge(var.common_tags, {
		308 |     Name        = &quot;${var.project_name}-${var.environment}-api-logs&quot;
		309 |     Environment = var.environment
		310 |   })
		311 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions">
Resource: aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]
File: /apigateway.tf: 338-366
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355

		338 | resource &quot;aws_iam_policy&quot; &quot;api_gateway_cloudwatch_logs_policy&quot; {
		339 |   count       = var.enable_api_gateway_logging ? 1 : 0
		340 |   name        = &quot;${var.project_name}-${var.environment}-apigateway-cloudwatch-logs-policy&quot;
		341 |   description = &quot;Permite a API Gateway escribir logs en CloudWatch&quot;
		342 | 
		343 |   policy = jsonencode({
		344 |     Version = &quot;2012-10-17&quot;
		345 |     Statement = [
		346 |       {
		347 |         Action = [
		348 |           &quot;logs:CreateLogGroup&quot;,
		349 |           &quot;logs:CreateLogStream&quot;,
		350 |           &quot;logs:DescribeLogGroups&quot;,
		351 |           &quot;logs:DescribeLogStreams&quot;,
		352 |           &quot;logs:PutLogEvents&quot;,
		353 |           &quot;logs:GetResourcePolicy&quot;,
		354 |           &quot;logs:PutResourcePolicy&quot;
		355 |         ],
		356 |         Effect   = &quot;Allow&quot;,
		357 |         Resource = &quot;*&quot;
		358 |       },
		359 |     ]
		360 |   })
		361 | 
		362 |   tags = merge(var.common_tags, {
		363 |     Name        = &quot;${var.project_name}-${var.environment}-api-cloudwatch-policy&quot;
		364 |     Environment = var.environment
		365 |   })
		366 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/apigateway.tf.aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]" file="/apigateway.tf">
			<failure type="failure" message="Ensure IAM policies does not allow write access without constraints">
Resource: aws_iam_policy.api_gateway_cloudwatch_logs_policy[0]
File: /apigateway.tf: 338-366
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290

		338 | resource &quot;aws_iam_policy&quot; &quot;api_gateway_cloudwatch_logs_policy&quot; {
		339 |   count       = var.enable_api_gateway_logging ? 1 : 0
		340 |   name        = &quot;${var.project_name}-${var.environment}-apigateway-cloudwatch-logs-policy&quot;
		341 |   description = &quot;Permite a API Gateway escribir logs en CloudWatch&quot;
		342 | 
		343 |   policy = jsonencode({
		344 |     Version = &quot;2012-10-17&quot;
		345 |     Statement = [
		346 |       {
		347 |         Action = [
		348 |           &quot;logs:CreateLogGroup&quot;,
		349 |           &quot;logs:CreateLogStream&quot;,
		350 |           &quot;logs:DescribeLogGroups&quot;,
		351 |           &quot;logs:DescribeLogStreams&quot;,
		352 |           &quot;logs:PutLogEvents&quot;,
		353 |           &quot;logs:GetResourcePolicy&quot;,
		354 |           &quot;logs:PutResourcePolicy&quot;
		355 |         ],
		356 |         Effect   = &quot;Allow&quot;,
		357 |         Resource = &quot;*&quot;
		358 |       },
		359 |     ]
		360 |   })
		361 | 
		362 |   tags = merge(var.common_tags, {
		363 |     Name        = &quot;${var.project_name}-${var.environment}-api-cloudwatch-policy&quot;
		364 |     Environment = var.environment
		365 |   })
		366 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_310] Ensure CloudFront distributions should have origin failover configured" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf">
			<failure type="failure" message="Ensure CloudFront distributions should have origin failover configured">
Resource: aws_cloudfront_distribution.website
File: /cloudfront.tf: 11-117
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_174] Verify CloudFront Distribution Viewer Certificate is using TLS v1.2 or higher" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf">
			<failure type="failure" message="Verify CloudFront Distribution Viewer Certificate is using TLS v1.2 or higher">
Resource: aws_cloudfront_distribution.website
File: /cloudfront.tf: 11-117
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-63

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_86] Ensure CloudFront distribution has Access Logging enabled" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf">
			<failure type="failure" message="Ensure CloudFront distribution has Access Logging enabled">
Resource: aws_cloudfront_distribution.website
File: /cloudfront.tf: 11-117
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-20

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_374] Ensure AWS CloudFront web distribution has geo restriction enabled" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf">
			<failure type="failure" message="Ensure AWS CloudFront web distribution has geo restriction enabled">
Resource: aws_cloudfront_distribution.website
File: /cloudfront.tf: 11-117
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_259] Ensure CloudFront response header policy enforces Strict Transport Security" classname="/cloudfront.tf.aws_cloudfront_response_headers_policy.security_headers" file="/cloudfront.tf">
			<failure type="failure" message="Ensure CloudFront response header policy enforces Strict Transport Security">
Resource: aws_cloudfront_response_headers_policy.security_headers
File: /cloudfront.tf: 120-145
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-cloudfront-response-header-policy-enforces-strict-transport-security

		120 | resource &quot;aws_cloudfront_response_headers_policy&quot; &quot;security_headers&quot; {
		121 |   name    = &quot;${var.project_name}-${var.environment}-security-headers&quot;
		122 |   comment = &quot;Security headers for ${var.project_name}&quot;
		123 | 
		124 |   security_headers_config {
		125 |     strict_transport_security {
		126 |       access_control_max_age_sec = 63072000
		127 |       include_subdomains         = true
		128 |       override                   = true
		129 |     }
		130 | 
		131 |     content_type_options {
		132 |       override = true
		133 |     }
		134 | 
		135 |     frame_options {
		136 |       frame_option = &quot;DENY&quot;
		137 |       override     = true
		138 |     }
		139 | 
		140 |     referrer_policy {
		141 |       referrer_policy = &quot;strict-origin-when-cross-origin&quot;
		142 |       override        = true
		143 |     }
		144 |   }
		145 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf">
			<failure type="failure" message="Ensure IAM policies does not allow permissions management / resource exposure without constraints">
Resource: aws_iam_role_policy.authenticated
File: /cognito.tf: 186-203
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289

		186 | resource &quot;aws_iam_role_policy&quot; &quot;authenticated&quot; {
		187 |   name = &quot;${var.project_name}-${var.environment}-authenticated-policy&quot;
		188 |   role = aws_iam_role.authenticated.id
		189 | 
		190 |   policy = jsonencode({
		191 |     Version = &quot;2012-10-17&quot;
		192 |     Statement = [
		193 |       {
		194 |         Effect = &quot;Allow&quot;
		195 |         Action = [
		196 |           &quot;cognito-sync:*&quot;,
		197 |           &quot;cognito-identity:*&quot;
		198 |         ]
		199 |         Resource = &quot;*&quot;
		200 |       }
		201 |     ]
		202 |   })
		203 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions">
Resource: aws_iam_role_policy.authenticated
File: /cognito.tf: 186-203
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355

		186 | resource &quot;aws_iam_role_policy&quot; &quot;authenticated&quot; {
		187 |   name = &quot;${var.project_name}-${var.environment}-authenticated-policy&quot;
		188 |   role = aws_iam_role.authenticated.id
		189 | 
		190 |   policy = jsonencode({
		191 |     Version = &quot;2012-10-17&quot;
		192 |     Statement = [
		193 |       {
		194 |         Effect = &quot;Allow&quot;
		195 |         Action = [
		196 |           &quot;cognito-sync:*&quot;,
		197 |           &quot;cognito-identity:*&quot;
		198 |         ]
		199 |         Resource = &quot;*&quot;
		200 |       }
		201 |     ]
		202 |   })
		203 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf">
			<failure type="failure" message="Ensure IAM policies does not allow write access without constraints">
Resource: aws_iam_role_policy.authenticated
File: /cognito.tf: 186-203
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290

		186 | resource &quot;aws_iam_role_policy&quot; &quot;authenticated&quot; {
		187 |   name = &quot;${var.project_name}-${var.environment}-authenticated-policy&quot;
		188 |   role = aws_iam_role.authenticated.id
		189 | 
		190 |   policy = jsonencode({
		191 |     Version = &quot;2012-10-17&quot;
		192 |     Statement = [
		193 |       {
		194 |         Effect = &quot;Allow&quot;
		195 |         Action = [
		196 |           &quot;cognito-sync:*&quot;,
		197 |           &quot;cognito-identity:*&quot;
		198 |         ]
		199 |         Resource = &quot;*&quot;
		200 |       }
		201 |     ]
		202 |   })
		203 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/cognito.tf.aws_iam_role_policy.authenticated" file="/cognito.tf">
			<failure type="failure" message="Ensure IAM policies does not allow credentials exposure">
Resource: aws_iam_role_policy.authenticated
File: /cognito.tf: 186-203
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287

		186 | resource &quot;aws_iam_role_policy&quot; &quot;authenticated&quot; {
		187 |   name = &quot;${var.project_name}-${var.environment}-authenticated-policy&quot;
		188 |   role = aws_iam_role.authenticated.id
		189 | 
		190 |   policy = jsonencode({
		191 |     Version = &quot;2012-10-17&quot;
		192 |     Statement = [
		193 |       {
		194 |         Effect = &quot;Allow&quot;
		195 |         Action = [
		196 |           &quot;cognito-sync:*&quot;,
		197 |           &quot;cognito-identity:*&quot;
		198 |         ]
		199 |         Resource = &quot;*&quot;
		200 |       }
		201 |     ]
		202 |   })
		203 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_109] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf">
			<failure type="failure" message="Ensure IAM policies does not allow permissions management / resource exposure without constraints">
Resource: aws_iam_policy_document.kms_policy
File: /dynamodb.tf: 50-81
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint

		50 | data &quot;aws_iam_policy_document&quot; &quot;kms_policy&quot; {
		51 |   statement {
		52 |     sid    = &quot;Enable IAM User Permissions&quot;
		53 |     effect = &quot;Allow&quot;
		54 |     principals {
		55 |       type        = &quot;AWS&quot;
		56 |       identifiers = [&quot;arn:aws:iam::${data.aws_caller_identity.current.account_id}:root&quot;]
		57 |     }
		58 |     actions   = [&quot;kms:*&quot;]
		59 |     resources = [&quot;*&quot;]
		60 |   }
		61 | 
		62 |   statement {
		63 |     sid    = &quot;Allow Lambda access&quot;
		64 |     effect = &quot;Allow&quot;
		65 |     actions = [
		66 |       &quot;kms:Decrypt&quot;,
		67 |       &quot;kms:GenerateDataKey&quot;,
		68 |       &quot;kms:DescribeKey&quot;
		69 |     ]
		70 |     resources = [&quot;*&quot;]
		71 |     principals {
		72 |       type = &quot;AWS&quot;
		73 |       identifiers = [
		74 |         aws_iam_role.lambda_registrations_exec_role.arn,
		75 |         aws_iam_role.lambda_catalogo_exec_role.arn,
		76 |         aws_iam_role.lambda_card_exec_role.arn,
		77 |         aws_iam_role.lambda_orderandshipping_exec_role.arn
		78 |       ]
		79 |     }
		80 |   }
		81 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_111] Ensure IAM policies does not allow write access without constraints" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf">
			<failure type="failure" message="Ensure IAM policies does not allow write access without constraints">
Resource: aws_iam_policy_document.kms_policy
File: /dynamodb.tf: 50-81
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint

		50 | data &quot;aws_iam_policy_document&quot; &quot;kms_policy&quot; {
		51 |   statement {
		52 |     sid    = &quot;Enable IAM User Permissions&quot;
		53 |     effect = &quot;Allow&quot;
		54 |     principals {
		55 |       type        = &quot;AWS&quot;
		56 |       identifiers = [&quot;arn:aws:iam::${data.aws_caller_identity.current.account_id}:root&quot;]
		57 |     }
		58 |     actions   = [&quot;kms:*&quot;]
		59 |     resources = [&quot;*&quot;]
		60 |   }
		61 | 
		62 |   statement {
		63 |     sid    = &quot;Allow Lambda access&quot;
		64 |     effect = &quot;Allow&quot;
		65 |     actions = [
		66 |       &quot;kms:Decrypt&quot;,
		67 |       &quot;kms:GenerateDataKey&quot;,
		68 |       &quot;kms:DescribeKey&quot;
		69 |     ]
		70 |     resources = [&quot;*&quot;]
		71 |     principals {
		72 |       type = &quot;AWS&quot;
		73 |       identifiers = [
		74 |         aws_iam_role.lambda_registrations_exec_role.arn,
		75 |         aws_iam_role.lambda_catalogo_exec_role.arn,
		76 |         aws_iam_role.lambda_card_exec_role.arn,
		77 |         aws_iam_role.lambda_orderandshipping_exec_role.arn
		78 |       ]
		79 |     }
		80 |   }
		81 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_356] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/dynamodb.tf.aws_iam_policy_document.kms_policy" file="/dynamodb.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions">
Resource: aws_iam_policy_document.kms_policy
File: /dynamodb.tf: 50-81
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-356

		50 | data &quot;aws_iam_policy_document&quot; &quot;kms_policy&quot; {
		51 |   statement {
		52 |     sid    = &quot;Enable IAM User Permissions&quot;
		53 |     effect = &quot;Allow&quot;
		54 |     principals {
		55 |       type        = &quot;AWS&quot;
		56 |       identifiers = [&quot;arn:aws:iam::${data.aws_caller_identity.current.account_id}:root&quot;]
		57 |     }
		58 |     actions   = [&quot;kms:*&quot;]
		59 |     resources = [&quot;*&quot;]
		60 |   }
		61 | 
		62 |   statement {
		63 |     sid    = &quot;Allow Lambda access&quot;
		64 |     effect = &quot;Allow&quot;
		65 |     actions = [
		66 |       &quot;kms:Decrypt&quot;,
		67 |       &quot;kms:GenerateDataKey&quot;,
		68 |       &quot;kms:DescribeKey&quot;
		69 |     ]
		70 |     resources = [&quot;*&quot;]
		71 |     principals {
		72 |       type = &quot;AWS&quot;
		73 |       identifiers = [
		74 |         aws_iam_role.lambda_registrations_exec_role.arn,
		75 |         aws_iam_role.lambda_catalogo_exec_role.arn,
		76 |         aws_iam_role.lambda_card_exec_role.arn,
		77 |         aws_iam_role.lambda_orderandshipping_exec_role.arn
		78 |       ]
		79 |     }
		80 |   }
		81 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/lambda-card.tf.aws_cloudwatch_log_group.card_logs" file="/lambda-card.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.card_logs
File: /lambda-card.tf: 27-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		27 | resource &quot;aws_cloudwatch_log_group&quot; &quot;card_logs&quot; {
		28 |   name              = &quot;/aws/lambda/${var.project_name}-card&quot;
		29 |   retention_in_days = var.cloudwatch_log_retention_days
		30 | 
		31 |   tags = var.common_tags
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/lambda-card.tf.aws_cloudwatch_log_group.card_logs" file="/lambda-card.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.card_logs
File: /lambda-card.tf: 27-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		27 | resource &quot;aws_cloudwatch_log_group&quot; &quot;card_logs&quot; {
		28 |   name              = &quot;/aws/lambda/${var.project_name}-card&quot;
		29 |   retention_in_days = var.cloudwatch_log_retention_days
		30 | 
		31 |   tags = var.common_tags
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.card
File: /lambda-card.tf: 59-90
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		59 | resource &quot;aws_lambda_function&quot; &quot;card&quot; {
		60 |   function_name    = &quot;${var.project_name}-card&quot;
		61 |   handler          = &quot;index.handler&quot;
		62 |   runtime          = var.lambda_runtime
		63 |   role             = aws_iam_role.lambda_card_exec_role.arn
		64 |   filename         = data.archive_file.lambda_card.output_path
		65 |   source_code_hash = data.archive_file.lambda_card.output_base64sha256
		66 |   timeout          = var.lambda_timeout
		67 |   memory_size      = var.lambda_memory_size
		68 | 
		69 |   vpc_config {
		70 |     subnet_ids         = aws_subnet.private[*].id
		71 |     security_group_ids = [aws_security_group.lambda.id]
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = {
		76 |       CARDS_TABLE        = aws_dynamodb_table.cards_table.name
		77 |       USERS_TABLE        = aws_dynamodb_table.users_table.name
		78 |       LOG_LEVEL          = var.log_level
		79 |       PURCHASE_QUEUE_URL = aws_sqs_queue.purchase_queue.url
		80 |     }
		81 |   }
		82 | 
		83 |   tags = var.common_tags
		84 |   depends_on = [
		85 |     aws_cloudwatch_log_group.card_logs,
		86 |     aws_iam_role_policy_attachment.card_logs_attach,
		87 |     aws_iam_role_policy_attachment.card_dynamodb_attach,
		88 |     aws_iam_role_policy_attachment.card_kms_attach
		89 |   ]
		90 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.card
File: /lambda-card.tf: 59-90
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		59 | resource &quot;aws_lambda_function&quot; &quot;card&quot; {
		60 |   function_name    = &quot;${var.project_name}-card&quot;
		61 |   handler          = &quot;index.handler&quot;
		62 |   runtime          = var.lambda_runtime
		63 |   role             = aws_iam_role.lambda_card_exec_role.arn
		64 |   filename         = data.archive_file.lambda_card.output_path
		65 |   source_code_hash = data.archive_file.lambda_card.output_base64sha256
		66 |   timeout          = var.lambda_timeout
		67 |   memory_size      = var.lambda_memory_size
		68 | 
		69 |   vpc_config {
		70 |     subnet_ids         = aws_subnet.private[*].id
		71 |     security_group_ids = [aws_security_group.lambda.id]
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = {
		76 |       CARDS_TABLE        = aws_dynamodb_table.cards_table.name
		77 |       USERS_TABLE        = aws_dynamodb_table.users_table.name
		78 |       LOG_LEVEL          = var.log_level
		79 |       PURCHASE_QUEUE_URL = aws_sqs_queue.purchase_queue.url
		80 |     }
		81 |   }
		82 | 
		83 |   tags = var.common_tags
		84 |   depends_on = [
		85 |     aws_cloudwatch_log_group.card_logs,
		86 |     aws_iam_role_policy_attachment.card_logs_attach,
		87 |     aws_iam_role_policy_attachment.card_dynamodb_attach,
		88 |     aws_iam_role_policy_attachment.card_kms_attach
		89 |   ]
		90 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.card
File: /lambda-card.tf: 59-90
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		59 | resource &quot;aws_lambda_function&quot; &quot;card&quot; {
		60 |   function_name    = &quot;${var.project_name}-card&quot;
		61 |   handler          = &quot;index.handler&quot;
		62 |   runtime          = var.lambda_runtime
		63 |   role             = aws_iam_role.lambda_card_exec_role.arn
		64 |   filename         = data.archive_file.lambda_card.output_path
		65 |   source_code_hash = data.archive_file.lambda_card.output_base64sha256
		66 |   timeout          = var.lambda_timeout
		67 |   memory_size      = var.lambda_memory_size
		68 | 
		69 |   vpc_config {
		70 |     subnet_ids         = aws_subnet.private[*].id
		71 |     security_group_ids = [aws_security_group.lambda.id]
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = {
		76 |       CARDS_TABLE        = aws_dynamodb_table.cards_table.name
		77 |       USERS_TABLE        = aws_dynamodb_table.users_table.name
		78 |       LOG_LEVEL          = var.log_level
		79 |       PURCHASE_QUEUE_URL = aws_sqs_queue.purchase_queue.url
		80 |     }
		81 |   }
		82 | 
		83 |   tags = var.common_tags
		84 |   depends_on = [
		85 |     aws_cloudwatch_log_group.card_logs,
		86 |     aws_iam_role_policy_attachment.card_logs_attach,
		87 |     aws_iam_role_policy_attachment.card_dynamodb_attach,
		88 |     aws_iam_role_policy_attachment.card_kms_attach
		89 |   ]
		90 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.card
File: /lambda-card.tf: 59-90
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		59 | resource &quot;aws_lambda_function&quot; &quot;card&quot; {
		60 |   function_name    = &quot;${var.project_name}-card&quot;
		61 |   handler          = &quot;index.handler&quot;
		62 |   runtime          = var.lambda_runtime
		63 |   role             = aws_iam_role.lambda_card_exec_role.arn
		64 |   filename         = data.archive_file.lambda_card.output_path
		65 |   source_code_hash = data.archive_file.lambda_card.output_base64sha256
		66 |   timeout          = var.lambda_timeout
		67 |   memory_size      = var.lambda_memory_size
		68 | 
		69 |   vpc_config {
		70 |     subnet_ids         = aws_subnet.private[*].id
		71 |     security_group_ids = [aws_security_group.lambda.id]
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = {
		76 |       CARDS_TABLE        = aws_dynamodb_table.cards_table.name
		77 |       USERS_TABLE        = aws_dynamodb_table.users_table.name
		78 |       LOG_LEVEL          = var.log_level
		79 |       PURCHASE_QUEUE_URL = aws_sqs_queue.purchase_queue.url
		80 |     }
		81 |   }
		82 | 
		83 |   tags = var.common_tags
		84 |   depends_on = [
		85 |     aws_cloudwatch_log_group.card_logs,
		86 |     aws_iam_role_policy_attachment.card_logs_attach,
		87 |     aws_iam_role_policy_attachment.card_dynamodb_attach,
		88 |     aws_iam_role_policy_attachment.card_kms_attach
		89 |   ]
		90 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf">
			<failure type="failure" message="Ensure Lambda Runtime is not deprecated">
Resource: aws_lambda_function.card
File: /lambda-card.tf: 59-90
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363

		59 | resource &quot;aws_lambda_function&quot; &quot;card&quot; {
		60 |   function_name    = &quot;${var.project_name}-card&quot;
		61 |   handler          = &quot;index.handler&quot;
		62 |   runtime          = var.lambda_runtime
		63 |   role             = aws_iam_role.lambda_card_exec_role.arn
		64 |   filename         = data.archive_file.lambda_card.output_path
		65 |   source_code_hash = data.archive_file.lambda_card.output_base64sha256
		66 |   timeout          = var.lambda_timeout
		67 |   memory_size      = var.lambda_memory_size
		68 | 
		69 |   vpc_config {
		70 |     subnet_ids         = aws_subnet.private[*].id
		71 |     security_group_ids = [aws_security_group.lambda.id]
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = {
		76 |       CARDS_TABLE        = aws_dynamodb_table.cards_table.name
		77 |       USERS_TABLE        = aws_dynamodb_table.users_table.name
		78 |       LOG_LEVEL          = var.log_level
		79 |       PURCHASE_QUEUE_URL = aws_sqs_queue.purchase_queue.url
		80 |     }
		81 |   }
		82 | 
		83 |   tags = var.common_tags
		84 |   depends_on = [
		85 |     aws_cloudwatch_log_group.card_logs,
		86 |     aws_iam_role_policy_attachment.card_logs_attach,
		87 |     aws_iam_role_policy_attachment.card_dynamodb_attach,
		88 |     aws_iam_role_policy_attachment.card_kms_attach
		89 |   ]
		90 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/lambda-card.tf.aws_lambda_function.card" file="/lambda-card.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.card
File: /lambda-card.tf: 59-90
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		59 | resource &quot;aws_lambda_function&quot; &quot;card&quot; {
		60 |   function_name    = &quot;${var.project_name}-card&quot;
		61 |   handler          = &quot;index.handler&quot;
		62 |   runtime          = var.lambda_runtime
		63 |   role             = aws_iam_role.lambda_card_exec_role.arn
		64 |   filename         = data.archive_file.lambda_card.output_path
		65 |   source_code_hash = data.archive_file.lambda_card.output_base64sha256
		66 |   timeout          = var.lambda_timeout
		67 |   memory_size      = var.lambda_memory_size
		68 | 
		69 |   vpc_config {
		70 |     subnet_ids         = aws_subnet.private[*].id
		71 |     security_group_ids = [aws_security_group.lambda.id]
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = {
		76 |       CARDS_TABLE        = aws_dynamodb_table.cards_table.name
		77 |       USERS_TABLE        = aws_dynamodb_table.users_table.name
		78 |       LOG_LEVEL          = var.log_level
		79 |       PURCHASE_QUEUE_URL = aws_sqs_queue.purchase_queue.url
		80 |     }
		81 |   }
		82 | 
		83 |   tags = var.common_tags
		84 |   depends_on = [
		85 |     aws_cloudwatch_log_group.card_logs,
		86 |     aws_iam_role_policy_attachment.card_logs_attach,
		87 |     aws_iam_role_policy_attachment.card_dynamodb_attach,
		88 |     aws_iam_role_policy_attachment.card_kms_attach
		89 |   ]
		90 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/lambda-catalogo.tf.aws_cloudwatch_log_group.catalogo_logs" file="/lambda-catalogo.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.catalogo_logs
File: /lambda-catalogo.tf: 26-30
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		26 | resource &quot;aws_cloudwatch_log_group&quot; &quot;catalogo_logs&quot; {
		27 |   name              = &quot;/aws/lambda/${var.project_name}-catalogo&quot;
		28 |   retention_in_days = var.cloudwatch_log_retention_days
		29 |   tags              = var.common_tags
		30 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/lambda-catalogo.tf.aws_cloudwatch_log_group.catalogo_logs" file="/lambda-catalogo.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.catalogo_logs
File: /lambda-catalogo.tf: 26-30
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		26 | resource &quot;aws_cloudwatch_log_group&quot; &quot;catalogo_logs&quot; {
		27 |   name              = &quot;/aws/lambda/${var.project_name}-catalogo&quot;
		28 |   retention_in_days = var.cloudwatch_log_retention_days
		29 |   tags              = var.common_tags
		30 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.catalogo
File: /lambda-catalogo.tf: 79-103
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		79  | resource &quot;aws_lambda_function&quot; &quot;catalogo&quot; {
		80  |   function_name    = &quot;${var.project_name}-catalogo&quot;
		81  |   handler          = &quot;index.handler&quot;
		82  |   runtime          = var.lambda_runtime
		83  |   role             = aws_iam_role.lambda_catalogo_exec_role.arn
		84  |   filename         = data.archive_file.lambda_catalogo.output_path
		85  |   source_code_hash = data.archive_file.lambda_catalogo.output_base64sha256
		86  |   timeout          = var.lambda_timeout
		87  |   memory_size      = var.lambda_memory_size
		88  | 
		89  |   vpc_config {
		90  |     subnet_ids         = aws_subnet.private[*].id
		91  |     security_group_ids = [aws_security_group.lambda.id]
		92  |   }
		93  | 
		94  |   environment {
		95  |     variables = {
		96  |       PRODUCTS_TABLE = &quot;${var.project_name}-products&quot;
		97  |       LOG_LEVEL      = var.log_level
		98  |     }
		99  |   }
		100 | 
		101 |   tags       = var.common_tags
		102 |   depends_on = [aws_cloudwatch_log_group.catalogo_logs]
		103 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.catalogo
File: /lambda-catalogo.tf: 79-103
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		79  | resource &quot;aws_lambda_function&quot; &quot;catalogo&quot; {
		80  |   function_name    = &quot;${var.project_name}-catalogo&quot;
		81  |   handler          = &quot;index.handler&quot;
		82  |   runtime          = var.lambda_runtime
		83  |   role             = aws_iam_role.lambda_catalogo_exec_role.arn
		84  |   filename         = data.archive_file.lambda_catalogo.output_path
		85  |   source_code_hash = data.archive_file.lambda_catalogo.output_base64sha256
		86  |   timeout          = var.lambda_timeout
		87  |   memory_size      = var.lambda_memory_size
		88  | 
		89  |   vpc_config {
		90  |     subnet_ids         = aws_subnet.private[*].id
		91  |     security_group_ids = [aws_security_group.lambda.id]
		92  |   }
		93  | 
		94  |   environment {
		95  |     variables = {
		96  |       PRODUCTS_TABLE = &quot;${var.project_name}-products&quot;
		97  |       LOG_LEVEL      = var.log_level
		98  |     }
		99  |   }
		100 | 
		101 |   tags       = var.common_tags
		102 |   depends_on = [aws_cloudwatch_log_group.catalogo_logs]
		103 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.catalogo
File: /lambda-catalogo.tf: 79-103
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		79  | resource &quot;aws_lambda_function&quot; &quot;catalogo&quot; {
		80  |   function_name    = &quot;${var.project_name}-catalogo&quot;
		81  |   handler          = &quot;index.handler&quot;
		82  |   runtime          = var.lambda_runtime
		83  |   role             = aws_iam_role.lambda_catalogo_exec_role.arn
		84  |   filename         = data.archive_file.lambda_catalogo.output_path
		85  |   source_code_hash = data.archive_file.lambda_catalogo.output_base64sha256
		86  |   timeout          = var.lambda_timeout
		87  |   memory_size      = var.lambda_memory_size
		88  | 
		89  |   vpc_config {
		90  |     subnet_ids         = aws_subnet.private[*].id
		91  |     security_group_ids = [aws_security_group.lambda.id]
		92  |   }
		93  | 
		94  |   environment {
		95  |     variables = {
		96  |       PRODUCTS_TABLE = &quot;${var.project_name}-products&quot;
		97  |       LOG_LEVEL      = var.log_level
		98  |     }
		99  |   }
		100 | 
		101 |   tags       = var.common_tags
		102 |   depends_on = [aws_cloudwatch_log_group.catalogo_logs]
		103 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.catalogo
File: /lambda-catalogo.tf: 79-103
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		79  | resource &quot;aws_lambda_function&quot; &quot;catalogo&quot; {
		80  |   function_name    = &quot;${var.project_name}-catalogo&quot;
		81  |   handler          = &quot;index.handler&quot;
		82  |   runtime          = var.lambda_runtime
		83  |   role             = aws_iam_role.lambda_catalogo_exec_role.arn
		84  |   filename         = data.archive_file.lambda_catalogo.output_path
		85  |   source_code_hash = data.archive_file.lambda_catalogo.output_base64sha256
		86  |   timeout          = var.lambda_timeout
		87  |   memory_size      = var.lambda_memory_size
		88  | 
		89  |   vpc_config {
		90  |     subnet_ids         = aws_subnet.private[*].id
		91  |     security_group_ids = [aws_security_group.lambda.id]
		92  |   }
		93  | 
		94  |   environment {
		95  |     variables = {
		96  |       PRODUCTS_TABLE = &quot;${var.project_name}-products&quot;
		97  |       LOG_LEVEL      = var.log_level
		98  |     }
		99  |   }
		100 | 
		101 |   tags       = var.common_tags
		102 |   depends_on = [aws_cloudwatch_log_group.catalogo_logs]
		103 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf">
			<failure type="failure" message="Ensure Lambda Runtime is not deprecated">
Resource: aws_lambda_function.catalogo
File: /lambda-catalogo.tf: 79-103
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363

		79  | resource &quot;aws_lambda_function&quot; &quot;catalogo&quot; {
		80  |   function_name    = &quot;${var.project_name}-catalogo&quot;
		81  |   handler          = &quot;index.handler&quot;
		82  |   runtime          = var.lambda_runtime
		83  |   role             = aws_iam_role.lambda_catalogo_exec_role.arn
		84  |   filename         = data.archive_file.lambda_catalogo.output_path
		85  |   source_code_hash = data.archive_file.lambda_catalogo.output_base64sha256
		86  |   timeout          = var.lambda_timeout
		87  |   memory_size      = var.lambda_memory_size
		88  | 
		89  |   vpc_config {
		90  |     subnet_ids         = aws_subnet.private[*].id
		91  |     security_group_ids = [aws_security_group.lambda.id]
		92  |   }
		93  | 
		94  |   environment {
		95  |     variables = {
		96  |       PRODUCTS_TABLE = &quot;${var.project_name}-products&quot;
		97  |       LOG_LEVEL      = var.log_level
		98  |     }
		99  |   }
		100 | 
		101 |   tags       = var.common_tags
		102 |   depends_on = [aws_cloudwatch_log_group.catalogo_logs]
		103 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/lambda-catalogo.tf.aws_lambda_function.catalogo" file="/lambda-catalogo.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.catalogo
File: /lambda-catalogo.tf: 79-103
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		79  | resource &quot;aws_lambda_function&quot; &quot;catalogo&quot; {
		80  |   function_name    = &quot;${var.project_name}-catalogo&quot;
		81  |   handler          = &quot;index.handler&quot;
		82  |   runtime          = var.lambda_runtime
		83  |   role             = aws_iam_role.lambda_catalogo_exec_role.arn
		84  |   filename         = data.archive_file.lambda_catalogo.output_path
		85  |   source_code_hash = data.archive_file.lambda_catalogo.output_base64sha256
		86  |   timeout          = var.lambda_timeout
		87  |   memory_size      = var.lambda_memory_size
		88  | 
		89  |   vpc_config {
		90  |     subnet_ids         = aws_subnet.private[*].id
		91  |     security_group_ids = [aws_security_group.lambda.id]
		92  |   }
		93  | 
		94  |   environment {
		95  |     variables = {
		96  |       PRODUCTS_TABLE = &quot;${var.project_name}-products&quot;
		97  |       LOG_LEVEL      = var.log_level
		98  |     }
		99  |   }
		100 | 
		101 |   tags       = var.common_tags
		102 |   depends_on = [aws_cloudwatch_log_group.catalogo_logs]
		103 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/lambda-ordenAndShipping.tf.aws_cloudwatch_log_group.orderandshipping_logs" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.orderandshipping_logs
File: /lambda-ordenAndShipping.tf: 26-30
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		26 | resource &quot;aws_cloudwatch_log_group&quot; &quot;orderandshipping_logs&quot; {
		27 |   name              = &quot;/aws/lambda/${var.project_name}-orderandshipping&quot;
		28 |   retention_in_days = var.cloudwatch_log_retention_days
		29 |   tags              = var.common_tags
		30 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/lambda-ordenAndShipping.tf.aws_cloudwatch_log_group.orderandshipping_logs" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.orderandshipping_logs
File: /lambda-ordenAndShipping.tf: 26-30
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		26 | resource &quot;aws_cloudwatch_log_group&quot; &quot;orderandshipping_logs&quot; {
		27 |   name              = &quot;/aws/lambda/${var.project_name}-orderandshipping&quot;
		28 |   retention_in_days = var.cloudwatch_log_retention_days
		29 |   tags              = var.common_tags
		30 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions">
Resource: aws_iam_policy.orderandshipping_ses_policy
File: /lambda-ordenAndShipping.tf: 87-102
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355

		87  | resource &quot;aws_iam_policy&quot; &quot;orderandshipping_ses_policy&quot; {
		88  |   name        = &quot;${var.project_name}-orderandshipping-ses-policy&quot;
		89  |   description = &quot;Permisos para SES de Order and Shipping&quot;
		90  | 
		91  |   policy = jsonencode({
		92  |     Version = &quot;2012-10-17&quot;,
		93  |     Statement = [{
		94  |       Action = [
		95  |         &quot;ses:SendEmail&quot;,
		96  |         &quot;ses:SendRawEmail&quot;
		97  |       ],
		98  |       Effect   = &quot;Allow&quot;,
		99  |       Resource = &quot;*&quot;
		100 |     }]
		101 |   })
		102 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-ordenAndShipping.tf.aws_iam_policy.orderandshipping_ses_policy" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Ensure IAM policies does not allow write access without constraints">
Resource: aws_iam_policy.orderandshipping_ses_policy
File: /lambda-ordenAndShipping.tf: 87-102
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290

		87  | resource &quot;aws_iam_policy&quot; &quot;orderandshipping_ses_policy&quot; {
		88  |   name        = &quot;${var.project_name}-orderandshipping-ses-policy&quot;
		89  |   description = &quot;Permisos para SES de Order and Shipping&quot;
		90  | 
		91  |   policy = jsonencode({
		92  |     Version = &quot;2012-10-17&quot;,
		93  |     Statement = [{
		94  |       Action = [
		95  |         &quot;ses:SendEmail&quot;,
		96  |         &quot;ses:SendRawEmail&quot;
		97  |       ],
		98  |       Effect   = &quot;Allow&quot;,
		99  |       Resource = &quot;*&quot;
		100 |     }]
		101 |   })
		102 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.orderandshipping
File: /lambda-ordenAndShipping.tf: 105-137
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		105 | resource &quot;aws_lambda_function&quot; &quot;orderandshipping&quot; {
		106 |   function_name    = &quot;${var.project_name}-orderandshipping&quot;
		107 |   handler          = &quot;index.handler&quot;
		108 |   runtime          = var.lambda_runtime
		109 |   role             = aws_iam_role.lambda_orderandshipping_exec_role.arn
		110 |   filename         = data.archive_file.lambda_orderandshipping.output_path
		111 |   source_code_hash = data.archive_file.lambda_orderandshipping.output_base64sha256
		112 |   timeout          = 60  # Mayor timeout para procesamiento de rdenes
		113 |   memory_size      = 512 # Mayor memoria para procesamiento de rdenes
		114 | 
		115 |   vpc_config {
		116 |     subnet_ids         = aws_subnet.private[*].id
		117 |     security_group_ids = [aws_security_group.lambda.id]
		118 |   }
		119 | 
		120 |   environment {
		121 |     variables = {
		122 |       # Tablas DynamoDB
		123 |       ORDERS_TABLE      = aws_dynamodb_table.orders_table.name
		124 |       ORDER_ITEMS_TABLE = aws_dynamodb_table.order_items_table.name
		125 |       SHIPPING_TABLE    = aws_dynamodb_table.shipping_table.name
		126 |       PRODUCTS_TABLE    = aws_dynamodb_table.products_table.name
		127 |       # NUEVO: Cola SQS para enviar notificaciones de email
		128 |       SEND_EMAILS_ORDER_QUEUE_URL = aws_sqs_queue.send_emails_order_queue.url
		129 |       # Configuracin
		130 |       LOG_LEVEL = var.log_level
		131 |       REGION    = var.aws_region
		132 |     }
		133 |   }
		134 | 
		135 |   tags       = var.common_tags
		136 |   depends_on = [aws_cloudwatch_log_group.orderandshipping_logs]
		137 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.orderandshipping
File: /lambda-ordenAndShipping.tf: 105-137
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		105 | resource &quot;aws_lambda_function&quot; &quot;orderandshipping&quot; {
		106 |   function_name    = &quot;${var.project_name}-orderandshipping&quot;
		107 |   handler          = &quot;index.handler&quot;
		108 |   runtime          = var.lambda_runtime
		109 |   role             = aws_iam_role.lambda_orderandshipping_exec_role.arn
		110 |   filename         = data.archive_file.lambda_orderandshipping.output_path
		111 |   source_code_hash = data.archive_file.lambda_orderandshipping.output_base64sha256
		112 |   timeout          = 60  # Mayor timeout para procesamiento de rdenes
		113 |   memory_size      = 512 # Mayor memoria para procesamiento de rdenes
		114 | 
		115 |   vpc_config {
		116 |     subnet_ids         = aws_subnet.private[*].id
		117 |     security_group_ids = [aws_security_group.lambda.id]
		118 |   }
		119 | 
		120 |   environment {
		121 |     variables = {
		122 |       # Tablas DynamoDB
		123 |       ORDERS_TABLE      = aws_dynamodb_table.orders_table.name
		124 |       ORDER_ITEMS_TABLE = aws_dynamodb_table.order_items_table.name
		125 |       SHIPPING_TABLE    = aws_dynamodb_table.shipping_table.name
		126 |       PRODUCTS_TABLE    = aws_dynamodb_table.products_table.name
		127 |       # NUEVO: Cola SQS para enviar notificaciones de email
		128 |       SEND_EMAILS_ORDER_QUEUE_URL = aws_sqs_queue.send_emails_order_queue.url
		129 |       # Configuracin
		130 |       LOG_LEVEL = var.log_level
		131 |       REGION    = var.aws_region
		132 |     }
		133 |   }
		134 | 
		135 |   tags       = var.common_tags
		136 |   depends_on = [aws_cloudwatch_log_group.orderandshipping_logs]
		137 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.orderandshipping
File: /lambda-ordenAndShipping.tf: 105-137
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		105 | resource &quot;aws_lambda_function&quot; &quot;orderandshipping&quot; {
		106 |   function_name    = &quot;${var.project_name}-orderandshipping&quot;
		107 |   handler          = &quot;index.handler&quot;
		108 |   runtime          = var.lambda_runtime
		109 |   role             = aws_iam_role.lambda_orderandshipping_exec_role.arn
		110 |   filename         = data.archive_file.lambda_orderandshipping.output_path
		111 |   source_code_hash = data.archive_file.lambda_orderandshipping.output_base64sha256
		112 |   timeout          = 60  # Mayor timeout para procesamiento de rdenes
		113 |   memory_size      = 512 # Mayor memoria para procesamiento de rdenes
		114 | 
		115 |   vpc_config {
		116 |     subnet_ids         = aws_subnet.private[*].id
		117 |     security_group_ids = [aws_security_group.lambda.id]
		118 |   }
		119 | 
		120 |   environment {
		121 |     variables = {
		122 |       # Tablas DynamoDB
		123 |       ORDERS_TABLE      = aws_dynamodb_table.orders_table.name
		124 |       ORDER_ITEMS_TABLE = aws_dynamodb_table.order_items_table.name
		125 |       SHIPPING_TABLE    = aws_dynamodb_table.shipping_table.name
		126 |       PRODUCTS_TABLE    = aws_dynamodb_table.products_table.name
		127 |       # NUEVO: Cola SQS para enviar notificaciones de email
		128 |       SEND_EMAILS_ORDER_QUEUE_URL = aws_sqs_queue.send_emails_order_queue.url
		129 |       # Configuracin
		130 |       LOG_LEVEL = var.log_level
		131 |       REGION    = var.aws_region
		132 |     }
		133 |   }
		134 | 
		135 |   tags       = var.common_tags
		136 |   depends_on = [aws_cloudwatch_log_group.orderandshipping_logs]
		137 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.orderandshipping
File: /lambda-ordenAndShipping.tf: 105-137
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		105 | resource &quot;aws_lambda_function&quot; &quot;orderandshipping&quot; {
		106 |   function_name    = &quot;${var.project_name}-orderandshipping&quot;
		107 |   handler          = &quot;index.handler&quot;
		108 |   runtime          = var.lambda_runtime
		109 |   role             = aws_iam_role.lambda_orderandshipping_exec_role.arn
		110 |   filename         = data.archive_file.lambda_orderandshipping.output_path
		111 |   source_code_hash = data.archive_file.lambda_orderandshipping.output_base64sha256
		112 |   timeout          = 60  # Mayor timeout para procesamiento de rdenes
		113 |   memory_size      = 512 # Mayor memoria para procesamiento de rdenes
		114 | 
		115 |   vpc_config {
		116 |     subnet_ids         = aws_subnet.private[*].id
		117 |     security_group_ids = [aws_security_group.lambda.id]
		118 |   }
		119 | 
		120 |   environment {
		121 |     variables = {
		122 |       # Tablas DynamoDB
		123 |       ORDERS_TABLE      = aws_dynamodb_table.orders_table.name
		124 |       ORDER_ITEMS_TABLE = aws_dynamodb_table.order_items_table.name
		125 |       SHIPPING_TABLE    = aws_dynamodb_table.shipping_table.name
		126 |       PRODUCTS_TABLE    = aws_dynamodb_table.products_table.name
		127 |       # NUEVO: Cola SQS para enviar notificaciones de email
		128 |       SEND_EMAILS_ORDER_QUEUE_URL = aws_sqs_queue.send_emails_order_queue.url
		129 |       # Configuracin
		130 |       LOG_LEVEL = var.log_level
		131 |       REGION    = var.aws_region
		132 |     }
		133 |   }
		134 | 
		135 |   tags       = var.common_tags
		136 |   depends_on = [aws_cloudwatch_log_group.orderandshipping_logs]
		137 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Ensure Lambda Runtime is not deprecated">
Resource: aws_lambda_function.orderandshipping
File: /lambda-ordenAndShipping.tf: 105-137
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363

		105 | resource &quot;aws_lambda_function&quot; &quot;orderandshipping&quot; {
		106 |   function_name    = &quot;${var.project_name}-orderandshipping&quot;
		107 |   handler          = &quot;index.handler&quot;
		108 |   runtime          = var.lambda_runtime
		109 |   role             = aws_iam_role.lambda_orderandshipping_exec_role.arn
		110 |   filename         = data.archive_file.lambda_orderandshipping.output_path
		111 |   source_code_hash = data.archive_file.lambda_orderandshipping.output_base64sha256
		112 |   timeout          = 60  # Mayor timeout para procesamiento de rdenes
		113 |   memory_size      = 512 # Mayor memoria para procesamiento de rdenes
		114 | 
		115 |   vpc_config {
		116 |     subnet_ids         = aws_subnet.private[*].id
		117 |     security_group_ids = [aws_security_group.lambda.id]
		118 |   }
		119 | 
		120 |   environment {
		121 |     variables = {
		122 |       # Tablas DynamoDB
		123 |       ORDERS_TABLE      = aws_dynamodb_table.orders_table.name
		124 |       ORDER_ITEMS_TABLE = aws_dynamodb_table.order_items_table.name
		125 |       SHIPPING_TABLE    = aws_dynamodb_table.shipping_table.name
		126 |       PRODUCTS_TABLE    = aws_dynamodb_table.products_table.name
		127 |       # NUEVO: Cola SQS para enviar notificaciones de email
		128 |       SEND_EMAILS_ORDER_QUEUE_URL = aws_sqs_queue.send_emails_order_queue.url
		129 |       # Configuracin
		130 |       LOG_LEVEL = var.log_level
		131 |       REGION    = var.aws_region
		132 |     }
		133 |   }
		134 | 
		135 |   tags       = var.common_tags
		136 |   depends_on = [aws_cloudwatch_log_group.orderandshipping_logs]
		137 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/lambda-ordenAndShipping.tf.aws_lambda_function.orderandshipping" file="/lambda-ordenAndShipping.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.orderandshipping
File: /lambda-ordenAndShipping.tf: 105-137
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		105 | resource &quot;aws_lambda_function&quot; &quot;orderandshipping&quot; {
		106 |   function_name    = &quot;${var.project_name}-orderandshipping&quot;
		107 |   handler          = &quot;index.handler&quot;
		108 |   runtime          = var.lambda_runtime
		109 |   role             = aws_iam_role.lambda_orderandshipping_exec_role.arn
		110 |   filename         = data.archive_file.lambda_orderandshipping.output_path
		111 |   source_code_hash = data.archive_file.lambda_orderandshipping.output_base64sha256
		112 |   timeout          = 60  # Mayor timeout para procesamiento de rdenes
		113 |   memory_size      = 512 # Mayor memoria para procesamiento de rdenes
		114 | 
		115 |   vpc_config {
		116 |     subnet_ids         = aws_subnet.private[*].id
		117 |     security_group_ids = [aws_security_group.lambda.id]
		118 |   }
		119 | 
		120 |   environment {
		121 |     variables = {
		122 |       # Tablas DynamoDB
		123 |       ORDERS_TABLE      = aws_dynamodb_table.orders_table.name
		124 |       ORDER_ITEMS_TABLE = aws_dynamodb_table.order_items_table.name
		125 |       SHIPPING_TABLE    = aws_dynamodb_table.shipping_table.name
		126 |       PRODUCTS_TABLE    = aws_dynamodb_table.products_table.name
		127 |       # NUEVO: Cola SQS para enviar notificaciones de email
		128 |       SEND_EMAILS_ORDER_QUEUE_URL = aws_sqs_queue.send_emails_order_queue.url
		129 |       # Configuracin
		130 |       LOG_LEVEL = var.log_level
		131 |       REGION    = var.aws_region
		132 |     }
		133 |   }
		134 | 
		135 |   tags       = var.common_tags
		136 |   depends_on = [aws_cloudwatch_log_group.orderandshipping_logs]
		137 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/lambda-purchase-confirmation.tf.aws_cloudwatch_log_group.purchase_confirmation_logs" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.purchase_confirmation_logs
File: /lambda-purchase-confirmation.tf: 27-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		27 | resource &quot;aws_cloudwatch_log_group&quot; &quot;purchase_confirmation_logs&quot; {
		28 |   name              = &quot;/aws/lambda/${var.project_name}-purchase-confirmation&quot;
		29 |   retention_in_days = var.cloudwatch_log_retention_days
		30 | 
		31 |   tags = var.common_tags
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/lambda-purchase-confirmation.tf.aws_cloudwatch_log_group.purchase_confirmation_logs" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.purchase_confirmation_logs
File: /lambda-purchase-confirmation.tf: 27-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		27 | resource &quot;aws_cloudwatch_log_group&quot; &quot;purchase_confirmation_logs&quot; {
		28 |   name              = &quot;/aws/lambda/${var.project_name}-purchase-confirmation&quot;
		29 |   retention_in_days = var.cloudwatch_log_retention_days
		30 | 
		31 |   tags = var.common_tags
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.purchase_confirmation
File: /lambda-purchase-confirmation.tf: 35-62
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		35 | resource &quot;aws_lambda_function&quot; &quot;purchase_confirmation&quot; {
		36 |   function_name    = &quot;${var.project_name}-purchase-confirmation&quot;
		37 |   handler          = &quot;index.handler&quot;
		38 |   runtime          = var.lambda_runtime
		39 |   role             = aws_iam_role.lambda_purchase_confirmation_role.arn
		40 |   filename         = data.archive_file.lambda_purchase_confirmation.output_path
		41 |   source_code_hash = data.archive_file.lambda_purchase_confirmation.output_base64sha256
		42 |   timeout          = var.lambda_timeout
		43 |   memory_size      = var.lambda_memory_size
		44 | 
		45 |   environment {
		46 |     variables = {
		47 |       LOG_LEVEL             = var.log_level
		48 |       SNS_TOPIC_ARN         = aws_sns_topic.email_notifications.arn
		49 |       ORDERS_TABLE          = aws_dynamodb_table.orders_table.name
		50 |       STRIPE_WEBHOOK_SECRET = var.stripe_webhook_secret
		51 |     }
		52 |   }
		53 | 
		54 |   # VPC Configuration
		55 |   vpc_config {
		56 |     subnet_ids         = aws_subnet.private[*].id
		57 |     security_group_ids = [aws_security_group.lambda.id]
		58 |   }
		59 | 
		60 |   tags       = var.common_tags
		61 |   depends_on = [aws_cloudwatch_log_group.purchase_confirmation_logs]
		62 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.purchase_confirmation
File: /lambda-purchase-confirmation.tf: 35-62
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		35 | resource &quot;aws_lambda_function&quot; &quot;purchase_confirmation&quot; {
		36 |   function_name    = &quot;${var.project_name}-purchase-confirmation&quot;
		37 |   handler          = &quot;index.handler&quot;
		38 |   runtime          = var.lambda_runtime
		39 |   role             = aws_iam_role.lambda_purchase_confirmation_role.arn
		40 |   filename         = data.archive_file.lambda_purchase_confirmation.output_path
		41 |   source_code_hash = data.archive_file.lambda_purchase_confirmation.output_base64sha256
		42 |   timeout          = var.lambda_timeout
		43 |   memory_size      = var.lambda_memory_size
		44 | 
		45 |   environment {
		46 |     variables = {
		47 |       LOG_LEVEL             = var.log_level
		48 |       SNS_TOPIC_ARN         = aws_sns_topic.email_notifications.arn
		49 |       ORDERS_TABLE          = aws_dynamodb_table.orders_table.name
		50 |       STRIPE_WEBHOOK_SECRET = var.stripe_webhook_secret
		51 |     }
		52 |   }
		53 | 
		54 |   # VPC Configuration
		55 |   vpc_config {
		56 |     subnet_ids         = aws_subnet.private[*].id
		57 |     security_group_ids = [aws_security_group.lambda.id]
		58 |   }
		59 | 
		60 |   tags       = var.common_tags
		61 |   depends_on = [aws_cloudwatch_log_group.purchase_confirmation_logs]
		62 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.purchase_confirmation
File: /lambda-purchase-confirmation.tf: 35-62
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		35 | resource &quot;aws_lambda_function&quot; &quot;purchase_confirmation&quot; {
		36 |   function_name    = &quot;${var.project_name}-purchase-confirmation&quot;
		37 |   handler          = &quot;index.handler&quot;
		38 |   runtime          = var.lambda_runtime
		39 |   role             = aws_iam_role.lambda_purchase_confirmation_role.arn
		40 |   filename         = data.archive_file.lambda_purchase_confirmation.output_path
		41 |   source_code_hash = data.archive_file.lambda_purchase_confirmation.output_base64sha256
		42 |   timeout          = var.lambda_timeout
		43 |   memory_size      = var.lambda_memory_size
		44 | 
		45 |   environment {
		46 |     variables = {
		47 |       LOG_LEVEL             = var.log_level
		48 |       SNS_TOPIC_ARN         = aws_sns_topic.email_notifications.arn
		49 |       ORDERS_TABLE          = aws_dynamodb_table.orders_table.name
		50 |       STRIPE_WEBHOOK_SECRET = var.stripe_webhook_secret
		51 |     }
		52 |   }
		53 | 
		54 |   # VPC Configuration
		55 |   vpc_config {
		56 |     subnet_ids         = aws_subnet.private[*].id
		57 |     security_group_ids = [aws_security_group.lambda.id]
		58 |   }
		59 | 
		60 |   tags       = var.common_tags
		61 |   depends_on = [aws_cloudwatch_log_group.purchase_confirmation_logs]
		62 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.purchase_confirmation
File: /lambda-purchase-confirmation.tf: 35-62
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		35 | resource &quot;aws_lambda_function&quot; &quot;purchase_confirmation&quot; {
		36 |   function_name    = &quot;${var.project_name}-purchase-confirmation&quot;
		37 |   handler          = &quot;index.handler&quot;
		38 |   runtime          = var.lambda_runtime
		39 |   role             = aws_iam_role.lambda_purchase_confirmation_role.arn
		40 |   filename         = data.archive_file.lambda_purchase_confirmation.output_path
		41 |   source_code_hash = data.archive_file.lambda_purchase_confirmation.output_base64sha256
		42 |   timeout          = var.lambda_timeout
		43 |   memory_size      = var.lambda_memory_size
		44 | 
		45 |   environment {
		46 |     variables = {
		47 |       LOG_LEVEL             = var.log_level
		48 |       SNS_TOPIC_ARN         = aws_sns_topic.email_notifications.arn
		49 |       ORDERS_TABLE          = aws_dynamodb_table.orders_table.name
		50 |       STRIPE_WEBHOOK_SECRET = var.stripe_webhook_secret
		51 |     }
		52 |   }
		53 | 
		54 |   # VPC Configuration
		55 |   vpc_config {
		56 |     subnet_ids         = aws_subnet.private[*].id
		57 |     security_group_ids = [aws_security_group.lambda.id]
		58 |   }
		59 | 
		60 |   tags       = var.common_tags
		61 |   depends_on = [aws_cloudwatch_log_group.purchase_confirmation_logs]
		62 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Ensure Lambda Runtime is not deprecated">
Resource: aws_lambda_function.purchase_confirmation
File: /lambda-purchase-confirmation.tf: 35-62
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363

		35 | resource &quot;aws_lambda_function&quot; &quot;purchase_confirmation&quot; {
		36 |   function_name    = &quot;${var.project_name}-purchase-confirmation&quot;
		37 |   handler          = &quot;index.handler&quot;
		38 |   runtime          = var.lambda_runtime
		39 |   role             = aws_iam_role.lambda_purchase_confirmation_role.arn
		40 |   filename         = data.archive_file.lambda_purchase_confirmation.output_path
		41 |   source_code_hash = data.archive_file.lambda_purchase_confirmation.output_base64sha256
		42 |   timeout          = var.lambda_timeout
		43 |   memory_size      = var.lambda_memory_size
		44 | 
		45 |   environment {
		46 |     variables = {
		47 |       LOG_LEVEL             = var.log_level
		48 |       SNS_TOPIC_ARN         = aws_sns_topic.email_notifications.arn
		49 |       ORDERS_TABLE          = aws_dynamodb_table.orders_table.name
		50 |       STRIPE_WEBHOOK_SECRET = var.stripe_webhook_secret
		51 |     }
		52 |   }
		53 | 
		54 |   # VPC Configuration
		55 |   vpc_config {
		56 |     subnet_ids         = aws_subnet.private[*].id
		57 |     security_group_ids = [aws_security_group.lambda.id]
		58 |   }
		59 | 
		60 |   tags       = var.common_tags
		61 |   depends_on = [aws_cloudwatch_log_group.purchase_confirmation_logs]
		62 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/lambda-purchase-confirmation.tf.aws_lambda_function.purchase_confirmation" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.purchase_confirmation
File: /lambda-purchase-confirmation.tf: 35-62
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		35 | resource &quot;aws_lambda_function&quot; &quot;purchase_confirmation&quot; {
		36 |   function_name    = &quot;${var.project_name}-purchase-confirmation&quot;
		37 |   handler          = &quot;index.handler&quot;
		38 |   runtime          = var.lambda_runtime
		39 |   role             = aws_iam_role.lambda_purchase_confirmation_role.arn
		40 |   filename         = data.archive_file.lambda_purchase_confirmation.output_path
		41 |   source_code_hash = data.archive_file.lambda_purchase_confirmation.output_base64sha256
		42 |   timeout          = var.lambda_timeout
		43 |   memory_size      = var.lambda_memory_size
		44 | 
		45 |   environment {
		46 |     variables = {
		47 |       LOG_LEVEL             = var.log_level
		48 |       SNS_TOPIC_ARN         = aws_sns_topic.email_notifications.arn
		49 |       ORDERS_TABLE          = aws_dynamodb_table.orders_table.name
		50 |       STRIPE_WEBHOOK_SECRET = var.stripe_webhook_secret
		51 |     }
		52 |   }
		53 | 
		54 |   # VPC Configuration
		55 |   vpc_config {
		56 |     subnet_ids         = aws_subnet.private[*].id
		57 |     security_group_ids = [aws_security_group.lambda.id]
		58 |   }
		59 | 
		60 |   tags       = var.common_tags
		61 |   depends_on = [aws_cloudwatch_log_group.purchase_confirmation_logs]
		62 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions">
Resource: aws_iam_policy.lambda_purchase_confirmation_policy
File: /lambda-purchase-confirmation.tf: 65-103
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355

		65  | resource &quot;aws_iam_policy&quot; &quot;lambda_purchase_confirmation_policy&quot; {
		66  |   name        = &quot;${var.project_name}-purchase-confirmation-policy&quot;
		67  |   description = &quot;Policy for the Purchase Confirmation Lambda&quot;
		68  | 
		69  |   policy = jsonencode({
		70  |     Version = &quot;2012-10-17&quot;
		71  |     Statement = [
		72  |       {
		73  |         Effect = &quot;Allow&quot;,
		74  |         Action = [
		75  |           &quot;logs:CreateLogGroup&quot;,
		76  |           &quot;logs:CreateLogStream&quot;,
		77  |           &quot;logs:PutLogEvents&quot;
		78  |         ],
		79  |         Resource = &quot;${aws_cloudwatch_log_group.purchase_confirmation_logs.arn}:*&quot;
		80  |       },
		81  |       {
		82  |         Effect   = &quot;Allow&quot;,
		83  |         Action   = &quot;sns:Publish&quot;,
		84  |         Resource = aws_sns_topic.email_notifications.arn
		85  |       },
		86  |       {
		87  |         Effect   = &quot;Allow&quot;,
		88  |         Action   = [&quot;dynamodb:UpdateItem&quot;, &quot;dynamodb:PutItem&quot;],
		89  |         Resource = aws_dynamodb_table.orders_table.arn
		90  |       },
		91  |       {
		92  |         # Permisos para ENI en VPC
		93  |         Effect = &quot;Allow&quot;,
		94  |         Action = [
		95  |           &quot;ec2:CreateNetworkInterface&quot;,
		96  |           &quot;ec2:DescribeNetworkInterfaces&quot;,
		97  |           &quot;ec2:DeleteNetworkInterface&quot;
		98  |         ],
		99  |         Resource = &quot;*&quot;
		100 |       }
		101 |     ]
		102 |   })
		103 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda-purchase-confirmation.tf.aws_iam_policy.lambda_purchase_confirmation_policy" file="/lambda-purchase-confirmation.tf">
			<failure type="failure" message="Ensure IAM policies does not allow write access without constraints">
Resource: aws_iam_policy.lambda_purchase_confirmation_policy
File: /lambda-purchase-confirmation.tf: 65-103
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290

		65  | resource &quot;aws_iam_policy&quot; &quot;lambda_purchase_confirmation_policy&quot; {
		66  |   name        = &quot;${var.project_name}-purchase-confirmation-policy&quot;
		67  |   description = &quot;Policy for the Purchase Confirmation Lambda&quot;
		68  | 
		69  |   policy = jsonencode({
		70  |     Version = &quot;2012-10-17&quot;
		71  |     Statement = [
		72  |       {
		73  |         Effect = &quot;Allow&quot;,
		74  |         Action = [
		75  |           &quot;logs:CreateLogGroup&quot;,
		76  |           &quot;logs:CreateLogStream&quot;,
		77  |           &quot;logs:PutLogEvents&quot;
		78  |         ],
		79  |         Resource = &quot;${aws_cloudwatch_log_group.purchase_confirmation_logs.arn}:*&quot;
		80  |       },
		81  |       {
		82  |         Effect   = &quot;Allow&quot;,
		83  |         Action   = &quot;sns:Publish&quot;,
		84  |         Resource = aws_sns_topic.email_notifications.arn
		85  |       },
		86  |       {
		87  |         Effect   = &quot;Allow&quot;,
		88  |         Action   = [&quot;dynamodb:UpdateItem&quot;, &quot;dynamodb:PutItem&quot;],
		89  |         Resource = aws_dynamodb_table.orders_table.arn
		90  |       },
		91  |       {
		92  |         # Permisos para ENI en VPC
		93  |         Effect = &quot;Allow&quot;,
		94  |         Action = [
		95  |           &quot;ec2:CreateNetworkInterface&quot;,
		96  |           &quot;ec2:DescribeNetworkInterfaces&quot;,
		97  |           &quot;ec2:DeleteNetworkInterface&quot;
		98  |         ],
		99  |         Resource = &quot;*&quot;
		100 |       }
		101 |     ]
		102 |   })
		103 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/lambda-purchase.tf.aws_cloudwatch_log_group.purchase_logs" file="/lambda-purchase.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.purchase_logs
File: /lambda-purchase.tf: 31-36
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		31 | resource &quot;aws_cloudwatch_log_group&quot; &quot;purchase_logs&quot; {
		32 |   name              = &quot;/aws/lambda/${var.project_name}-purchase&quot;
		33 |   retention_in_days = var.cloudwatch_log_retention_days
		34 | 
		35 |   tags = var.common_tags
		36 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/lambda-purchase.tf.aws_cloudwatch_log_group.purchase_logs" file="/lambda-purchase.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.purchase_logs
File: /lambda-purchase.tf: 31-36
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		31 | resource &quot;aws_cloudwatch_log_group&quot; &quot;purchase_logs&quot; {
		32 |   name              = &quot;/aws/lambda/${var.project_name}-purchase&quot;
		33 |   retention_in_days = var.cloudwatch_log_retention_days
		34 | 
		35 |   tags = var.common_tags
		36 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.purchase
File: /lambda-purchase.tf: 122-153
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		122 | resource &quot;aws_lambda_function&quot; &quot;purchase&quot; {
		123 |   function_name    = &quot;${var.project_name}-purchase&quot;
		124 |   handler          = &quot;index.handler&quot;
		125 |   runtime          = var.lambda_runtime
		126 |   role             = aws_iam_role.lambda_purchase_exec_role.arn
		127 |   filename         = data.archive_file.lambda_purchase.output_path
		128 |   source_code_hash = data.archive_file.lambda_purchase.output_base64sha256
		129 |   timeout          = var.lambda_timeout_purchase
		130 |   memory_size      = var.lambda_memory_size_purchase
		131 | 
		132 |   vpc_config {
		133 |     subnet_ids         = aws_subnet.private[*].id
		134 |     security_group_ids = [aws_security_group.lambda.id]
		135 |   }
		136 | 
		137 |   environment {
		138 |     variables = {
		139 |       LOG_LEVEL         = var.log_level
		140 |       REGION            = var.aws_region
		141 |       STRIPE_SECRET_KEY = var.stripe_secret_key
		142 |     }
		143 |   }
		144 | 
		145 |   tags = var.common_tags
		146 | 
		147 |   depends_on = [
		148 |     aws_cloudwatch_log_group.purchase_logs,
		149 |     aws_iam_role_policy_attachment.purchase_logs_attach,
		150 |     aws_iam_role_policy_attachment.purchase_dynamodb_attach,
		151 |     aws_iam_role_policy_attachment.purchase_kms_attach
		152 |   ]
		153 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.purchase
File: /lambda-purchase.tf: 122-153
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		122 | resource &quot;aws_lambda_function&quot; &quot;purchase&quot; {
		123 |   function_name    = &quot;${var.project_name}-purchase&quot;
		124 |   handler          = &quot;index.handler&quot;
		125 |   runtime          = var.lambda_runtime
		126 |   role             = aws_iam_role.lambda_purchase_exec_role.arn
		127 |   filename         = data.archive_file.lambda_purchase.output_path
		128 |   source_code_hash = data.archive_file.lambda_purchase.output_base64sha256
		129 |   timeout          = var.lambda_timeout_purchase
		130 |   memory_size      = var.lambda_memory_size_purchase
		131 | 
		132 |   vpc_config {
		133 |     subnet_ids         = aws_subnet.private[*].id
		134 |     security_group_ids = [aws_security_group.lambda.id]
		135 |   }
		136 | 
		137 |   environment {
		138 |     variables = {
		139 |       LOG_LEVEL         = var.log_level
		140 |       REGION            = var.aws_region
		141 |       STRIPE_SECRET_KEY = var.stripe_secret_key
		142 |     }
		143 |   }
		144 | 
		145 |   tags = var.common_tags
		146 | 
		147 |   depends_on = [
		148 |     aws_cloudwatch_log_group.purchase_logs,
		149 |     aws_iam_role_policy_attachment.purchase_logs_attach,
		150 |     aws_iam_role_policy_attachment.purchase_dynamodb_attach,
		151 |     aws_iam_role_policy_attachment.purchase_kms_attach
		152 |   ]
		153 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.purchase
File: /lambda-purchase.tf: 122-153
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		122 | resource &quot;aws_lambda_function&quot; &quot;purchase&quot; {
		123 |   function_name    = &quot;${var.project_name}-purchase&quot;
		124 |   handler          = &quot;index.handler&quot;
		125 |   runtime          = var.lambda_runtime
		126 |   role             = aws_iam_role.lambda_purchase_exec_role.arn
		127 |   filename         = data.archive_file.lambda_purchase.output_path
		128 |   source_code_hash = data.archive_file.lambda_purchase.output_base64sha256
		129 |   timeout          = var.lambda_timeout_purchase
		130 |   memory_size      = var.lambda_memory_size_purchase
		131 | 
		132 |   vpc_config {
		133 |     subnet_ids         = aws_subnet.private[*].id
		134 |     security_group_ids = [aws_security_group.lambda.id]
		135 |   }
		136 | 
		137 |   environment {
		138 |     variables = {
		139 |       LOG_LEVEL         = var.log_level
		140 |       REGION            = var.aws_region
		141 |       STRIPE_SECRET_KEY = var.stripe_secret_key
		142 |     }
		143 |   }
		144 | 
		145 |   tags = var.common_tags
		146 | 
		147 |   depends_on = [
		148 |     aws_cloudwatch_log_group.purchase_logs,
		149 |     aws_iam_role_policy_attachment.purchase_logs_attach,
		150 |     aws_iam_role_policy_attachment.purchase_dynamodb_attach,
		151 |     aws_iam_role_policy_attachment.purchase_kms_attach
		152 |   ]
		153 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.purchase
File: /lambda-purchase.tf: 122-153
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		122 | resource &quot;aws_lambda_function&quot; &quot;purchase&quot; {
		123 |   function_name    = &quot;${var.project_name}-purchase&quot;
		124 |   handler          = &quot;index.handler&quot;
		125 |   runtime          = var.lambda_runtime
		126 |   role             = aws_iam_role.lambda_purchase_exec_role.arn
		127 |   filename         = data.archive_file.lambda_purchase.output_path
		128 |   source_code_hash = data.archive_file.lambda_purchase.output_base64sha256
		129 |   timeout          = var.lambda_timeout_purchase
		130 |   memory_size      = var.lambda_memory_size_purchase
		131 | 
		132 |   vpc_config {
		133 |     subnet_ids         = aws_subnet.private[*].id
		134 |     security_group_ids = [aws_security_group.lambda.id]
		135 |   }
		136 | 
		137 |   environment {
		138 |     variables = {
		139 |       LOG_LEVEL         = var.log_level
		140 |       REGION            = var.aws_region
		141 |       STRIPE_SECRET_KEY = var.stripe_secret_key
		142 |     }
		143 |   }
		144 | 
		145 |   tags = var.common_tags
		146 | 
		147 |   depends_on = [
		148 |     aws_cloudwatch_log_group.purchase_logs,
		149 |     aws_iam_role_policy_attachment.purchase_logs_attach,
		150 |     aws_iam_role_policy_attachment.purchase_dynamodb_attach,
		151 |     aws_iam_role_policy_attachment.purchase_kms_attach
		152 |   ]
		153 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf">
			<failure type="failure" message="Ensure Lambda Runtime is not deprecated">
Resource: aws_lambda_function.purchase
File: /lambda-purchase.tf: 122-153
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363

		122 | resource &quot;aws_lambda_function&quot; &quot;purchase&quot; {
		123 |   function_name    = &quot;${var.project_name}-purchase&quot;
		124 |   handler          = &quot;index.handler&quot;
		125 |   runtime          = var.lambda_runtime
		126 |   role             = aws_iam_role.lambda_purchase_exec_role.arn
		127 |   filename         = data.archive_file.lambda_purchase.output_path
		128 |   source_code_hash = data.archive_file.lambda_purchase.output_base64sha256
		129 |   timeout          = var.lambda_timeout_purchase
		130 |   memory_size      = var.lambda_memory_size_purchase
		131 | 
		132 |   vpc_config {
		133 |     subnet_ids         = aws_subnet.private[*].id
		134 |     security_group_ids = [aws_security_group.lambda.id]
		135 |   }
		136 | 
		137 |   environment {
		138 |     variables = {
		139 |       LOG_LEVEL         = var.log_level
		140 |       REGION            = var.aws_region
		141 |       STRIPE_SECRET_KEY = var.stripe_secret_key
		142 |     }
		143 |   }
		144 | 
		145 |   tags = var.common_tags
		146 | 
		147 |   depends_on = [
		148 |     aws_cloudwatch_log_group.purchase_logs,
		149 |     aws_iam_role_policy_attachment.purchase_logs_attach,
		150 |     aws_iam_role_policy_attachment.purchase_dynamodb_attach,
		151 |     aws_iam_role_policy_attachment.purchase_kms_attach
		152 |   ]
		153 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/lambda-purchase.tf.aws_lambda_function.purchase" file="/lambda-purchase.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.purchase
File: /lambda-purchase.tf: 122-153
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		122 | resource &quot;aws_lambda_function&quot; &quot;purchase&quot; {
		123 |   function_name    = &quot;${var.project_name}-purchase&quot;
		124 |   handler          = &quot;index.handler&quot;
		125 |   runtime          = var.lambda_runtime
		126 |   role             = aws_iam_role.lambda_purchase_exec_role.arn
		127 |   filename         = data.archive_file.lambda_purchase.output_path
		128 |   source_code_hash = data.archive_file.lambda_purchase.output_base64sha256
		129 |   timeout          = var.lambda_timeout_purchase
		130 |   memory_size      = var.lambda_memory_size_purchase
		131 | 
		132 |   vpc_config {
		133 |     subnet_ids         = aws_subnet.private[*].id
		134 |     security_group_ids = [aws_security_group.lambda.id]
		135 |   }
		136 | 
		137 |   environment {
		138 |     variables = {
		139 |       LOG_LEVEL         = var.log_level
		140 |       REGION            = var.aws_region
		141 |       STRIPE_SECRET_KEY = var.stripe_secret_key
		142 |     }
		143 |   }
		144 | 
		145 |   tags = var.common_tags
		146 | 
		147 |   depends_on = [
		148 |     aws_cloudwatch_log_group.purchase_logs,
		149 |     aws_iam_role_policy_attachment.purchase_logs_attach,
		150 |     aws_iam_role_policy_attachment.purchase_dynamodb_attach,
		151 |     aws_iam_role_policy_attachment.purchase_kms_attach
		152 |   ]
		153 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/lambda-registrations.tf.aws_cloudwatch_log_group.registrations_logs" file="/lambda-registrations.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.registrations_logs
File: /lambda-registrations.tf: 26-30
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		26 | resource &quot;aws_cloudwatch_log_group&quot; &quot;registrations_logs&quot; {
		27 |   name              = &quot;/aws/lambda/${var.project_name}-registrations&quot;
		28 |   retention_in_days = var.cloudwatch_log_retention_days
		29 |   tags              = var.common_tags
		30 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/lambda-registrations.tf.aws_cloudwatch_log_group.registrations_logs" file="/lambda-registrations.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.registrations_logs
File: /lambda-registrations.tf: 26-30
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		26 | resource &quot;aws_cloudwatch_log_group&quot; &quot;registrations_logs&quot; {
		27 |   name              = &quot;/aws/lambda/${var.project_name}-registrations&quot;
		28 |   retention_in_days = var.cloudwatch_log_retention_days
		29 |   tags              = var.common_tags
		30 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.registrations
File: /lambda-registrations.tf: 75-100
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		75  | resource &quot;aws_lambda_function&quot; &quot;registrations&quot; {
		76  |   function_name    = &quot;${var.project_name}-registrations&quot;
		77  |   handler          = &quot;index.handler&quot;
		78  |   runtime          = var.lambda_runtime
		79  |   role             = aws_iam_role.lambda_registrations_exec_role.arn
		80  |   filename         = data.archive_file.lambda_registrations.output_path
		81  |   source_code_hash = data.archive_file.lambda_registrations.output_base64sha256
		82  |   timeout          = var.lambda_timeout
		83  |   memory_size      = var.lambda_memory_size
		84  | 
		85  |   vpc_config {
		86  |     subnet_ids         = aws_subnet.private[*].id
		87  |     security_group_ids = [aws_security_group.lambda.id]
		88  |   }
		89  | 
		90  |   environment {
		91  |     variables = {
		92  |       LOG_LEVEL            = var.log_level
		93  |       COGNITO_USER_POOL_ID = aws_cognito_user_pool.main.id
		94  |       COGNITO_CLIENT_ID    = aws_cognito_user_pool_client.web.id
		95  |     }
		96  |   }
		97  | 
		98  |   tags       = var.common_tags
		99  |   depends_on = [aws_cloudwatch_log_group.registrations_logs]
		100 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.registrations
File: /lambda-registrations.tf: 75-100
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		75  | resource &quot;aws_lambda_function&quot; &quot;registrations&quot; {
		76  |   function_name    = &quot;${var.project_name}-registrations&quot;
		77  |   handler          = &quot;index.handler&quot;
		78  |   runtime          = var.lambda_runtime
		79  |   role             = aws_iam_role.lambda_registrations_exec_role.arn
		80  |   filename         = data.archive_file.lambda_registrations.output_path
		81  |   source_code_hash = data.archive_file.lambda_registrations.output_base64sha256
		82  |   timeout          = var.lambda_timeout
		83  |   memory_size      = var.lambda_memory_size
		84  | 
		85  |   vpc_config {
		86  |     subnet_ids         = aws_subnet.private[*].id
		87  |     security_group_ids = [aws_security_group.lambda.id]
		88  |   }
		89  | 
		90  |   environment {
		91  |     variables = {
		92  |       LOG_LEVEL            = var.log_level
		93  |       COGNITO_USER_POOL_ID = aws_cognito_user_pool.main.id
		94  |       COGNITO_CLIENT_ID    = aws_cognito_user_pool_client.web.id
		95  |     }
		96  |   }
		97  | 
		98  |   tags       = var.common_tags
		99  |   depends_on = [aws_cloudwatch_log_group.registrations_logs]
		100 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.registrations
File: /lambda-registrations.tf: 75-100
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		75  | resource &quot;aws_lambda_function&quot; &quot;registrations&quot; {
		76  |   function_name    = &quot;${var.project_name}-registrations&quot;
		77  |   handler          = &quot;index.handler&quot;
		78  |   runtime          = var.lambda_runtime
		79  |   role             = aws_iam_role.lambda_registrations_exec_role.arn
		80  |   filename         = data.archive_file.lambda_registrations.output_path
		81  |   source_code_hash = data.archive_file.lambda_registrations.output_base64sha256
		82  |   timeout          = var.lambda_timeout
		83  |   memory_size      = var.lambda_memory_size
		84  | 
		85  |   vpc_config {
		86  |     subnet_ids         = aws_subnet.private[*].id
		87  |     security_group_ids = [aws_security_group.lambda.id]
		88  |   }
		89  | 
		90  |   environment {
		91  |     variables = {
		92  |       LOG_LEVEL            = var.log_level
		93  |       COGNITO_USER_POOL_ID = aws_cognito_user_pool.main.id
		94  |       COGNITO_CLIENT_ID    = aws_cognito_user_pool_client.web.id
		95  |     }
		96  |   }
		97  | 
		98  |   tags       = var.common_tags
		99  |   depends_on = [aws_cloudwatch_log_group.registrations_logs]
		100 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.registrations
File: /lambda-registrations.tf: 75-100
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		75  | resource &quot;aws_lambda_function&quot; &quot;registrations&quot; {
		76  |   function_name    = &quot;${var.project_name}-registrations&quot;
		77  |   handler          = &quot;index.handler&quot;
		78  |   runtime          = var.lambda_runtime
		79  |   role             = aws_iam_role.lambda_registrations_exec_role.arn
		80  |   filename         = data.archive_file.lambda_registrations.output_path
		81  |   source_code_hash = data.archive_file.lambda_registrations.output_base64sha256
		82  |   timeout          = var.lambda_timeout
		83  |   memory_size      = var.lambda_memory_size
		84  | 
		85  |   vpc_config {
		86  |     subnet_ids         = aws_subnet.private[*].id
		87  |     security_group_ids = [aws_security_group.lambda.id]
		88  |   }
		89  | 
		90  |   environment {
		91  |     variables = {
		92  |       LOG_LEVEL            = var.log_level
		93  |       COGNITO_USER_POOL_ID = aws_cognito_user_pool.main.id
		94  |       COGNITO_CLIENT_ID    = aws_cognito_user_pool_client.web.id
		95  |     }
		96  |   }
		97  | 
		98  |   tags       = var.common_tags
		99  |   depends_on = [aws_cloudwatch_log_group.registrations_logs]
		100 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf">
			<failure type="failure" message="Ensure Lambda Runtime is not deprecated">
Resource: aws_lambda_function.registrations
File: /lambda-registrations.tf: 75-100
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363

		75  | resource &quot;aws_lambda_function&quot; &quot;registrations&quot; {
		76  |   function_name    = &quot;${var.project_name}-registrations&quot;
		77  |   handler          = &quot;index.handler&quot;
		78  |   runtime          = var.lambda_runtime
		79  |   role             = aws_iam_role.lambda_registrations_exec_role.arn
		80  |   filename         = data.archive_file.lambda_registrations.output_path
		81  |   source_code_hash = data.archive_file.lambda_registrations.output_base64sha256
		82  |   timeout          = var.lambda_timeout
		83  |   memory_size      = var.lambda_memory_size
		84  | 
		85  |   vpc_config {
		86  |     subnet_ids         = aws_subnet.private[*].id
		87  |     security_group_ids = [aws_security_group.lambda.id]
		88  |   }
		89  | 
		90  |   environment {
		91  |     variables = {
		92  |       LOG_LEVEL            = var.log_level
		93  |       COGNITO_USER_POOL_ID = aws_cognito_user_pool.main.id
		94  |       COGNITO_CLIENT_ID    = aws_cognito_user_pool_client.web.id
		95  |     }
		96  |   }
		97  | 
		98  |   tags       = var.common_tags
		99  |   depends_on = [aws_cloudwatch_log_group.registrations_logs]
		100 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/lambda-registrations.tf.aws_lambda_function.registrations" file="/lambda-registrations.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.registrations
File: /lambda-registrations.tf: 75-100
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		75  | resource &quot;aws_lambda_function&quot; &quot;registrations&quot; {
		76  |   function_name    = &quot;${var.project_name}-registrations&quot;
		77  |   handler          = &quot;index.handler&quot;
		78  |   runtime          = var.lambda_runtime
		79  |   role             = aws_iam_role.lambda_registrations_exec_role.arn
		80  |   filename         = data.archive_file.lambda_registrations.output_path
		81  |   source_code_hash = data.archive_file.lambda_registrations.output_base64sha256
		82  |   timeout          = var.lambda_timeout
		83  |   memory_size      = var.lambda_memory_size
		84  | 
		85  |   vpc_config {
		86  |     subnet_ids         = aws_subnet.private[*].id
		87  |     security_group_ids = [aws_security_group.lambda.id]
		88  |   }
		89  | 
		90  |   environment {
		91  |     variables = {
		92  |       LOG_LEVEL            = var.log_level
		93  |       COGNITO_USER_POOL_ID = aws_cognito_user_pool.main.id
		94  |       COGNITO_CLIENT_ID    = aws_cognito_user_pool_client.web.id
		95  |     }
		96  |   }
		97  | 
		98  |   tags       = var.common_tags
		99  |   depends_on = [aws_cloudwatch_log_group.registrations_logs]
		100 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_27] Ensure all data stored in the SQS queue is encrypted" classname="/queueEmails.tf.aws_sqs_queue.email_dlq" file="/queueEmails.tf">
			<failure type="failure" message="Ensure all data stored in the SQS queue is encrypted">
Resource: aws_sqs_queue.email_dlq
File: /queueEmails.tf: 6-16
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		6  | resource &quot;aws_sqs_queue&quot; &quot;email_dlq&quot; {
		7  |   name                      = &quot;${var.project_name}-email-dlq&quot;
		8  |   message_retention_seconds = var.sqs_dlq_message_retention
		9  | 
		10 |   tags = merge(
		11 |     var.common_tags,
		12 |     {
		13 |       Purpose = &quot;Dead Letter Queue for Emails&quot;
		14 |     }
		15 |   )
		16 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_27] Ensure all data stored in the SQS queue is encrypted" classname="/queueEmails.tf.aws_sqs_queue.email_queue" file="/queueEmails.tf">
			<failure type="failure" message="Ensure all data stored in the SQS queue is encrypted">
Resource: aws_sqs_queue.email_queue
File: /queueEmails.tf: 19-39
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		19 | resource &quot;aws_sqs_queue&quot; &quot;email_queue&quot; {
		20 |   name                       = &quot;${var.project_name}-email-queue&quot;
		21 |   visibility_timeout_seconds = var.sqs_visibility_timeout_emails
		22 |   message_retention_seconds  = var.sqs_message_retention
		23 |   delay_seconds              = 0
		24 |   receive_wait_time_seconds  = var.sqs_receive_wait_time
		25 |   max_message_size           = 262144 # 256 KB
		26 | 
		27 |   # Dead Letter Queue configuration
		28 |   redrive_policy = jsonencode({
		29 |     deadLetterTargetArn = aws_sqs_queue.email_dlq.arn
		30 |     maxReceiveCount     = var.sqs_max_receive_count
		31 |   })
		32 | 
		33 |   tags = merge(
		34 |     var.common_tags,
		35 |     {
		36 |       Purpose = &quot;Email Queue&quot;
		37 |     }
		38 |   )
		39 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_26] Ensure all data stored in the SNS topic is encrypted" classname="/sns.tf.aws_sns_topic.email_notifications" file="/sns.tf">
			<failure type="failure" message="Ensure all data stored in the SNS topic is encrypted">
Resource: aws_sns_topic.email_notifications
File: /sns.tf: 5-8
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15

		5 | resource &quot;aws_sns_topic&quot; &quot;email_notifications&quot; {
		6 |   name = &quot;${var.project_name}-${var.environment}-email-notifications&quot;
		7 |   tags = var.common_tags
		8 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_27] Ensure all data stored in the SQS queue is encrypted" classname="/sqs.tf.aws_sqs_queue.purchase_queue" file="/sqs.tf">
			<failure type="failure" message="Ensure all data stored in the SQS queue is encrypted">
Resource: aws_sqs_queue.purchase_queue
File: /sqs.tf: 7-15
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		7  | resource &quot;aws_sqs_queue&quot; &quot;purchase_queue&quot; {
		8  |   name                      = &quot;${var.project_name}-purchase-queue&quot;
		9  |   delay_seconds             = 0
		10 |   max_message_size          = 2048  # 2KB
		11 |   message_retention_seconds = 86400 # 1 day
		12 |   receive_wait_time_seconds = 10
		13 | 
		14 |   tags = var.common_tags
		15 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_27] Ensure all data stored in the SQS queue is encrypted" classname="/sqs.tf.aws_sqs_queue.send_emails_order_queue" file="/sqs.tf">
			<failure type="failure" message="Ensure all data stored in the SQS queue is encrypted">
Resource: aws_sqs_queue.send_emails_order_queue
File: /sqs.tf: 18-26
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		18 | resource &quot;aws_sqs_queue&quot; &quot;send_emails_order_queue&quot; {
		19 |   name                      = &quot;${var.project_name}-send-emails-order-queue&quot;
		20 |   delay_seconds             = 0
		21 |   max_message_size          = 2048  # 2KB
		22 |   message_retention_seconds = 86400 # 1 day
		23 |   receive_wait_time_seconds = 10
		24 | 
		25 |   tags = var.common_tags
		26 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_130] Ensure VPC subnets do not assign public IP by default" classname="/vpc.tf.aws_subnet.public[0]" file="/vpc.tf">
			<failure type="failure" message="Ensure VPC subnets do not assign public IP by default">
Resource: aws_subnet.public[0]
File: /vpc.tf: 49-59
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default

		49 | resource &quot;aws_subnet&quot; &quot;public&quot; {
		50 |   count                   = length(var.public_subnets_cidr)
		51 |   vpc_id                  = aws_vpc.main.id
		52 |   cidr_block              = var.public_subnets_cidr[count.index]
		53 |   availability_zone       = data.aws_availability_zones.available.names[count.index]
		54 |   map_public_ip_on_launch = true
		55 | 
		56 |   tags = merge(var.common_tags, {
		57 |     Name = &quot;${var.project_name}-${var.environment}-public-subnet-${count.index + 1}&quot;
		58 |   })
		59 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_382] Ensure no security groups allow egress from 0.0.0.0:0 to port -1" classname="/vpc.tf.aws_security_group.lambda" file="/vpc.tf">
			<failure type="failure" message="Ensure no security groups allow egress from 0.0.0.0:0 to port -1">
Resource: aws_security_group.lambda
File: /vpc.tf: 136-151
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382

		136 | resource &quot;aws_security_group&quot; &quot;lambda&quot; {
		137 |   name        = &quot;${var.project_name}-${var.environment}-lambda-sg&quot;
		138 |   description = &quot;Security group for Lambda functions&quot;
		139 |   vpc_id      = aws_vpc.main.id
		140 | 
		141 |   egress {
		142 |     from_port   = 0
		143 |     to_port     = 0
		144 |     protocol    = &quot;-1&quot;
		145 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		146 |   }
		147 | 
		148 |   tags = merge(var.common_tags, {
		149 |     Name = &quot;${var.project_name}-${var.environment}-lambda-sg&quot;
		150 |   })
		151 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_23] Ensure every security group and rule has a description" classname="/vpc.tf.aws_security_group.lambda" file="/vpc.tf">
			<failure type="failure" message="Ensure every security group and rule has a description">
Resource: aws_security_group.lambda
File: /vpc.tf: 136-151
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31

		136 | resource &quot;aws_security_group&quot; &quot;lambda&quot; {
		137 |   name        = &quot;${var.project_name}-${var.environment}-lambda-sg&quot;
		138 |   description = &quot;Security group for Lambda functions&quot;
		139 |   vpc_id      = aws_vpc.main.id
		140 | 
		141 |   egress {
		142 |     from_port   = 0
		143 |     to_port     = 0
		144 |     protocol    = &quot;-1&quot;
		145 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		146 |   }
		147 | 
		148 |   tags = merge(var.common_tags, {
		149 |     Name = &quot;${var.project_name}-${var.environment}-lambda-sg&quot;
		150 |   })
		151 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_130] Ensure VPC subnets do not assign public IP by default" classname="/vpc.tf.aws_subnet.public[1]" file="/vpc.tf">
			<failure type="failure" message="Ensure VPC subnets do not assign public IP by default">
Resource: aws_subnet.public[1]
File: /vpc.tf: 49-59
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default

		49 | resource &quot;aws_subnet&quot; &quot;public&quot; {
		50 |   count                   = length(var.public_subnets_cidr)
		51 |   vpc_id                  = aws_vpc.main.id
		52 |   cidr_block              = var.public_subnets_cidr[count.index]
		53 |   availability_zone       = data.aws_availability_zones.available.names[count.index]
		54 |   map_public_ip_on_launch = true
		55 | 
		56 |   tags = merge(var.common_tags, {
		57 |     Name = &quot;${var.project_name}-${var.environment}-public-subnet-${count.index + 1}&quot;
		58 |   })
		59 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_192] Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell" classname="/waf.tf.aws_wafv2_web_acl.main" file="/waf.tf">
			<failure type="failure" message="Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell">
Resource: aws_wafv2_web_acl.main
File: /waf.tf: 20-62
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-waf-prevents-message-lookup-in-log4j2

		20 | resource &quot;aws_wafv2_web_acl&quot; &quot;main&quot; {
		21 |   provider    = aws.waf_region
		22 |   name        = &quot;${var.project_name}-${var.environment}-waf&quot;
		23 |   description = &quot;WAF for ${var.project_name} CloudFront distribution&quot;
		24 |   scope       = &quot;CLOUDFRONT&quot;
		25 | 
		26 |   default_action {
		27 |     allow {}
		28 |   }
		29 | 
		30 |   # Reglas administradas por AWS
		31 |   dynamic &quot;rule&quot; {
		32 |     for_each = var.waf_managed_rules
		33 |     content {
		34 |       name     = rule.key
		35 |       priority = rule.value.priority
		36 |       override_action {
		37 |         none {}
		38 |       }
		39 |       statement {
		40 |         managed_rule_group_statement {
		41 |           name        = rule.key
		42 |           vendor_name = &quot;AWS&quot;
		43 |         }
		44 |       }
		45 |       visibility_config {
		46 |         cloudwatch_metrics_enabled = true
		47 |         metric_name                = rule.key
		48 |         sampled_requests_enabled   = true
		49 |       }
		50 |     }
		51 |   }
		52 | 
		53 |   visibility_config {
		54 |     cloudwatch_metrics_enabled = true
		55 |     metric_name                = &quot;${var.project_name}-${var.environment}-waf&quot;
		56 |     sampled_requests_enabled   = true
		57 |   }
		58 | 
		59 |   tags = merge(var.common_tags, {
		60 |     Name = &quot;${var.project_name}-${var.environment}-waf&quot;
		61 |   })
		62 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_51] Ensure AWS API Gateway endpoints uses client certificate authentication" classname="/apigateway.tf.aws_api_gateway_stage.main" file="/apigateway.tf">
			<failure type="failure" message="Ensure AWS API Gateway endpoints uses client certificate authentication">
Resource: aws_api_gateway_stage.main
File: /apigateway.tf: 269-299
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-51

		269 | resource &quot;aws_api_gateway_stage&quot; &quot;main&quot; {
		270 |   stage_name    = var.environment
		271 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		272 |   deployment_id = aws_api_gateway_deployment.main.id
		273 | 
		274 |   depends_on = [aws_api_gateway_account.main]
		275 | 
		276 |   dynamic &quot;access_log_settings&quot; {
		277 |     for_each = var.enable_api_gateway_logging ? [1] : []
		278 |     content {
		279 |       destination_arn = aws_cloudwatch_log_group.api_gateway[0].arn
		280 |       format = jsonencode({
		281 |         requestId      = &quot;$context.requestId&quot;
		282 |         ip             = &quot;$context.identity.sourceIp&quot;
		283 |         caller         = &quot;$context.identity.caller&quot;
		284 |         user           = &quot;$context.identity.user&quot;
		285 |         requestTime    = &quot;$context.requestTime&quot;
		286 |         httpMethod     = &quot;$context.httpMethod&quot;
		287 |         resourcePath   = &quot;$context.resourcePath&quot;
		288 |         status         = &quot;$context.status&quot;
		289 |         protocol       = &quot;$context.protocol&quot;
		290 |         responseLength = &quot;$context.response.header.Content-Length&quot;
		291 |       })
		292 |     }
		293 |   }
		294 | 
		295 |   tags = merge(var.common_tags, {
		296 |     Name        = &quot;${var.project_name}-${var.environment}-api-stage&quot;
		297 |     Environment = var.environment
		298 |   })
		299 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_12] Ensure the default security group of every VPC restricts all traffic" classname="/vpc.tf.aws_vpc.main" file="/vpc.tf">
			<failure type="failure" message="Ensure the default security group of every VPC restricts all traffic">
Resource: aws_vpc.main
File: /vpc.tf: 29-37
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4

		29 | resource &quot;aws_vpc&quot; &quot;main&quot; {
		30 |   cidr_block           = var.vpc_cidr
		31 |   enable_dns_support   = true
		32 |   enable_dns_hostnames = true
		33 | 
		34 |   tags = merge(var.common_tags, {
		35 |     Name = &quot;${var.project_name}-${var.environment}-vpc&quot;
		36 |   })
		37 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_62] Ensure S3 buckets should have event notifications enabled" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf">
			<failure type="failure" message="Ensure S3 buckets should have event notifications enabled">
Resource: aws_s3_bucket.website
File: /s3.tf: 1-7
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62

		1 | resource &quot;aws_s3_bucket&quot; &quot;website&quot; {
		2 |   bucket = &quot;${var.project_name}-${var.environment}--website&quot;
		3 |   tags = {
		4 |     Name        = &quot;${var.project_name}-${var.environment}-website&quot;
		5 |     Environment = var.environment
		6 |   }
		7 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_11] Ensure VPC flow logging is enabled in all VPCs" classname="/vpc.tf.aws_vpc.main" file="/vpc.tf">
			<failure type="failure" message="Ensure VPC flow logging is enabled in all VPCs">
Resource: aws_vpc.main
File: /vpc.tf: 29-37
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging

		29 | resource &quot;aws_vpc&quot; &quot;main&quot; {
		30 |   cidr_block           = var.vpc_cidr
		31 |   enable_dns_support   = true
		32 |   enable_dns_hostnames = true
		33 | 
		34 |   tags = merge(var.common_tags, {
		35 |     Name = &quot;${var.project_name}-${var.environment}-vpc&quot;
		36 |   })
		37 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_47] Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf">
			<failure type="failure" message="Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability">
Resource: aws_cloudfront_distribution.website
File: /cloudfront.tf: 11-117
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_31] Ensure WAF2 has a Logging Configuration" classname="/waf.tf.aws_wafv2_web_acl.main" file="/waf.tf">
			<failure type="failure" message="Ensure WAF2 has a Logging Configuration">
Resource: aws_wafv2_web_acl.main
File: /waf.tf: 20-62
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-33

		20 | resource &quot;aws_wafv2_web_acl&quot; &quot;main&quot; {
		21 |   provider    = aws.waf_region
		22 |   name        = &quot;${var.project_name}-${var.environment}-waf&quot;
		23 |   description = &quot;WAF for ${var.project_name} CloudFront distribution&quot;
		24 |   scope       = &quot;CLOUDFRONT&quot;
		25 | 
		26 |   default_action {
		27 |     allow {}
		28 |   }
		29 | 
		30 |   # Reglas administradas por AWS
		31 |   dynamic &quot;rule&quot; {
		32 |     for_each = var.waf_managed_rules
		33 |     content {
		34 |       name     = rule.key
		35 |       priority = rule.value.priority
		36 |       override_action {
		37 |         none {}
		38 |       }
		39 |       statement {
		40 |         managed_rule_group_statement {
		41 |           name        = rule.key
		42 |           vendor_name = &quot;AWS&quot;
		43 |         }
		44 |       }
		45 |       visibility_config {
		46 |         cloudwatch_metrics_enabled = true
		47 |         metric_name                = rule.key
		48 |         sampled_requests_enabled   = true
		49 |       }
		50 |     }
		51 |   }
		52 | 
		53 |   visibility_config {
		54 |     cloudwatch_metrics_enabled = true
		55 |     metric_name                = &quot;${var.project_name}-${var.environment}-waf&quot;
		56 |     sampled_requests_enabled   = true
		57 |   }
		58 | 
		59 |   tags = merge(var.common_tags, {
		60 |     Name = &quot;${var.project_name}-${var.environment}-waf&quot;
		61 |   })
		62 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_18] Ensure the S3 bucket has access logging enabled" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf">
			<failure type="failure" message="Ensure the S3 bucket has access logging enabled">
Resource: aws_s3_bucket.website
File: /s3.tf: 1-7
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging

		1 | resource &quot;aws_s3_bucket&quot; &quot;website&quot; {
		2 |   bucket = &quot;${var.project_name}-${var.environment}--website&quot;
		3 |   tags = {
		4 |     Name        = &quot;${var.project_name}-${var.environment}-website&quot;
		5 |     Environment = var.environment
		6 |   }
		7 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_42] Ensure AWS CloudFront distribution uses custom SSL certificate" classname="/cloudfront.tf.aws_cloudfront_distribution.website" file="/cloudfront.tf">
			<failure type="failure" message="Ensure AWS CloudFront distribution uses custom SSL certificate">
Resource: aws_cloudfront_distribution.website
File: /cloudfront.tf: 11-117
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-cloudfront-distribution-uses-custom-ssl-certificate

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_61] Ensure that an S3 bucket has a lifecycle configuration" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf">
			<failure type="failure" message="Ensure that an S3 bucket has a lifecycle configuration">
Resource: aws_s3_bucket.website
File: /s3.tf: 1-7
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61

		1 | resource &quot;aws_s3_bucket&quot; &quot;website&quot; {
		2 |   bucket = &quot;${var.project_name}-${var.environment}--website&quot;
		3 |   tags = {
		4 |     Name        = &quot;${var.project_name}-${var.environment}-website&quot;
		5 |     Environment = var.environment
		6 |   }
		7 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_29] Ensure public API gateway are protected by WAF" classname="/apigateway.tf.aws_api_gateway_stage.main" file="/apigateway.tf">
			<failure type="failure" message="Ensure public API gateway are protected by WAF">
Resource: aws_api_gateway_stage.main
File: /apigateway.tf: 269-299
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-public-api-gateway-are-protected-by-waf

		269 | resource &quot;aws_api_gateway_stage&quot; &quot;main&quot; {
		270 |   stage_name    = var.environment
		271 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		272 |   deployment_id = aws_api_gateway_deployment.main.id
		273 | 
		274 |   depends_on = [aws_api_gateway_account.main]
		275 | 
		276 |   dynamic &quot;access_log_settings&quot; {
		277 |     for_each = var.enable_api_gateway_logging ? [1] : []
		278 |     content {
		279 |       destination_arn = aws_cloudwatch_log_group.api_gateway[0].arn
		280 |       format = jsonencode({
		281 |         requestId      = &quot;$context.requestId&quot;
		282 |         ip             = &quot;$context.identity.sourceIp&quot;
		283 |         caller         = &quot;$context.identity.caller&quot;
		284 |         user           = &quot;$context.identity.user&quot;
		285 |         requestTime    = &quot;$context.requestTime&quot;
		286 |         httpMethod     = &quot;$context.httpMethod&quot;
		287 |         resourcePath   = &quot;$context.resourcePath&quot;
		288 |         status         = &quot;$context.status&quot;
		289 |         protocol       = &quot;$context.protocol&quot;
		290 |         responseLength = &quot;$context.response.header.Content-Length&quot;
		291 |       })
		292 |     }
		293 |   }
		294 | 
		295 |   tags = merge(var.common_tags, {
		296 |     Name        = &quot;${var.project_name}-${var.environment}-api-stage&quot;
		297 |     Environment = var.environment
		298 |   })
		299 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_145] Ensure that S3 buckets are encrypted with KMS by default" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf">
			<failure type="failure" message="Ensure that S3 buckets are encrypted with KMS by default">
Resource: aws_s3_bucket.website
File: /s3.tf: 1-7
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		1 | resource &quot;aws_s3_bucket&quot; &quot;website&quot; {
		2 |   bucket = &quot;${var.project_name}-${var.environment}--website&quot;
		3 |   tags = {
		4 |     Name        = &quot;${var.project_name}-${var.environment}-website&quot;
		5 |     Environment = var.environment
		6 |   }
		7 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="/apigateway.tf.aws_api_gateway_method.endpoint_methods" file="/apigateway.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: aws_api_gateway_method.endpoint_methods
File: /apigateway.tf: 111-132
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		111 | resource &quot;aws_api_gateway_method&quot; &quot;endpoint_methods&quot; {
		112 |   for_each = {
		113 |     for combo in flatten([for endpoint_key, endpoint in local.endpoints : [
		114 |       for method in endpoint.methods : {
		115 |         key           = &quot;${endpoint_key}_${method}&quot;
		116 |         endpoint_key  = endpoint_key
		117 |         method        = method
		118 |         authorization = endpoint.authorization
		119 |       } if method != &quot;OPTIONS&quot;
		120 |     ]]) : combo.key =&gt; combo
		121 |   }
		122 | 
		123 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		124 |   resource_id   = aws_api_gateway_resource.endpoints[each.value.endpoint_key].id
		125 |   http_method   = each.value.method
		126 |   authorization = each.value.authorization == &quot;COGNITO_USER_POOLS&quot; &amp;&amp; var.cognito_user_pool_arn != &quot;&quot; ? &quot;COGNITO_USER_POOLS&quot; : &quot;NONE&quot;
		127 |   authorizer_id = each.value.authorization == &quot;COGNITO_USER_POOLS&quot; &amp;&amp; var.cognito_user_pool_arn != &quot;&quot; ? aws_api_gateway_authorizer.cognito[0].id : null
		128 | 
		129 |   request_parameters = each.value.authorization == &quot;COGNITO_USER_POOLS&quot; &amp;&amp; var.cognito_user_pool_arn != &quot;&quot; ? {
		130 |     &quot;method.request.header.Authorization&quot; = true
		131 |   } : {}
		132 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;card&quot;]" file="/apigateway.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: aws_api_gateway_method.cors_method[&quot;card&quot;]
File: /apigateway.tf: 159-168
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		159 | resource &quot;aws_api_gateway_method&quot; &quot;cors_method&quot; {
		160 |   for_each = local.endpoints
		161 | 
		162 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		163 |   resource_id   = aws_api_gateway_resource.endpoints[each.key].id
		164 |   http_method   = &quot;OPTIONS&quot;
		165 |   authorization = &quot;NONE&quot;
		166 | 
		167 |   depends_on = [aws_api_gateway_resource.endpoints]
		168 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;catalogo&quot;]" file="/apigateway.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: aws_api_gateway_method.cors_method[&quot;catalogo&quot;]
File: /apigateway.tf: 159-168
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		159 | resource &quot;aws_api_gateway_method&quot; &quot;cors_method&quot; {
		160 |   for_each = local.endpoints
		161 | 
		162 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		163 |   resource_id   = aws_api_gateway_resource.endpoints[each.key].id
		164 |   http_method   = &quot;OPTIONS&quot;
		165 |   authorization = &quot;NONE&quot;
		166 | 
		167 |   depends_on = [aws_api_gateway_resource.endpoints]
		168 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;orderandshipping&quot;]" file="/apigateway.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: aws_api_gateway_method.cors_method[&quot;orderandshipping&quot;]
File: /apigateway.tf: 159-168
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		159 | resource &quot;aws_api_gateway_method&quot; &quot;cors_method&quot; {
		160 |   for_each = local.endpoints
		161 | 
		162 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		163 |   resource_id   = aws_api_gateway_resource.endpoints[each.key].id
		164 |   http_method   = &quot;OPTIONS&quot;
		165 |   authorization = &quot;NONE&quot;
		166 | 
		167 |   depends_on = [aws_api_gateway_resource.endpoints]
		168 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;purchase&quot;]" file="/apigateway.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: aws_api_gateway_method.cors_method[&quot;purchase&quot;]
File: /apigateway.tf: 159-168
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		159 | resource &quot;aws_api_gateway_method&quot; &quot;cors_method&quot; {
		160 |   for_each = local.endpoints
		161 | 
		162 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		163 |   resource_id   = aws_api_gateway_resource.endpoints[each.key].id
		164 |   http_method   = &quot;OPTIONS&quot;
		165 |   authorization = &quot;NONE&quot;
		166 | 
		167 |   depends_on = [aws_api_gateway_resource.endpoints]
		168 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;purchase-confirmation&quot;]" file="/apigateway.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: aws_api_gateway_method.cors_method[&quot;purchase-confirmation&quot;]
File: /apigateway.tf: 159-168
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		159 | resource &quot;aws_api_gateway_method&quot; &quot;cors_method&quot; {
		160 |   for_each = local.endpoints
		161 | 
		162 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		163 |   resource_id   = aws_api_gateway_resource.endpoints[each.key].id
		164 |   http_method   = &quot;OPTIONS&quot;
		165 |   authorization = &quot;NONE&quot;
		166 | 
		167 |   depends_on = [aws_api_gateway_resource.endpoints]
		168 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="/apigateway.tf.aws_api_gateway_method.cors_method[&quot;registrations&quot;]" file="/apigateway.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: aws_api_gateway_method.cors_method[&quot;registrations&quot;]
File: /apigateway.tf: 159-168
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		159 | resource &quot;aws_api_gateway_method&quot; &quot;cors_method&quot; {
		160 |   for_each = local.endpoints
		161 | 
		162 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		163 |   resource_id   = aws_api_gateway_resource.endpoints[each.key].id
		164 |   http_method   = &quot;OPTIONS&quot;
		165 |   authorization = &quot;NONE&quot;
		166 | 
		167 |   depends_on = [aws_api_gateway_resource.endpoints]
		168 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_4] Ensure API Gateway stage have logging level defined as appropriate" classname="/apigateway.tf.aws_api_gateway_stage.main" file="/apigateway.tf">
			<failure type="failure" message="Ensure API Gateway stage have logging level defined as appropriate">
Resource: aws_api_gateway_stage.main
File: /apigateway.tf: 269-299
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-api-gateway-stage-have-logging-level-defined-as-appropiate

		269 | resource &quot;aws_api_gateway_stage&quot; &quot;main&quot; {
		270 |   stage_name    = var.environment
		271 |   rest_api_id   = aws_api_gateway_rest_api.main.id
		272 |   deployment_id = aws_api_gateway_deployment.main.id
		273 | 
		274 |   depends_on = [aws_api_gateway_account.main]
		275 | 
		276 |   dynamic &quot;access_log_settings&quot; {
		277 |     for_each = var.enable_api_gateway_logging ? [1] : []
		278 |     content {
		279 |       destination_arn = aws_cloudwatch_log_group.api_gateway[0].arn
		280 |       format = jsonencode({
		281 |         requestId      = &quot;$context.requestId&quot;
		282 |         ip             = &quot;$context.identity.sourceIp&quot;
		283 |         caller         = &quot;$context.identity.caller&quot;
		284 |         user           = &quot;$context.identity.user&quot;
		285 |         requestTime    = &quot;$context.requestTime&quot;
		286 |         httpMethod     = &quot;$context.httpMethod&quot;
		287 |         resourcePath   = &quot;$context.resourcePath&quot;
		288 |         status         = &quot;$context.status&quot;
		289 |         protocol       = &quot;$context.protocol&quot;
		290 |         responseLength = &quot;$context.response.header.Content-Length&quot;
		291 |       })
		292 |     }
		293 |   }
		294 | 
		295 |   tags = merge(var.common_tags, {
		296 |     Name        = &quot;${var.project_name}-${var.environment}-api-stage&quot;
		297 |     Environment = var.environment
		298 |   })
		299 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_144] Ensure that S3 bucket has cross-region replication enabled" classname="/s3.tf.aws_s3_bucket.website" file="/s3.tf">
			<failure type="failure" message="Ensure that S3 bucket has cross-region replication enabled">
Resource: aws_s3_bucket.website
File: /s3.tf: 1-7
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled

		1 | resource &quot;aws_s3_bucket&quot; &quot;website&quot; {
		2 |   bucket = &quot;${var.project_name}-${var.environment}--website&quot;
		3 |   tags = {
		4 |     Name        = &quot;${var.project_name}-${var.environment}-website&quot;
		5 |     Environment = var.environment
		6 |   }
		7 | }
</failure>
		</testcase>
	</testsuite>
</testsuites>
